<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>Network Error Logging</title>
  <meta content="ED" name="w3c-status">
  <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-ED" rel="stylesheet">
  <meta content="Bikeshed version 97a1608be, updated Mon Feb 3 16:09:34 2025 -0800" name="generator">
  <link href="https://w3c.github.io/network-error-logging/" rel="canonical">
  <meta content="027a967ccd88b92cf9597a94b1a909fc566e85e3" name="revision">
  <meta content="dark light" name="color-scheme">
  <link href="https://www.w3.org/StyleSheets/TR/2021/dark.css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css">
<style>
.reportTypeGroup {
  margin-top: 1em; padding-top: 1ex;
  border-top: 1px solid black;
}
</style>
<style>/* Boilerplate: style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}
</style>
<style>/* Boilerplate: style-colors */
/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
</style>
<style>/* Boilerplate: style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* Boilerplate: style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
    --dfnpanel-target-bg: #ffc;
    --dfnpanel-target-outline: orange;
}
@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
        --dfnpanel-target-bg: #333;
        --dfnpanel-target-outline: silver;
    }
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel a:focus {
    outline: 5px auto Highlight;
    outline: 5px auto -webkit-focus-ring-color;
}
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0 0 0 1em; list-style: none; }
.dfn-panel li a {
    max-width: calc(300px - 1.5em - 1em);
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: 8px;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
    transition: left 1s ease-out, bottom 1s ease-out;
}

.dfn-panel .link-item:hover {
    text-decoration: underline;
}
.dfn-panel .link-item .copy-icon {
    opacity: 0;
}
.dfn-panel .link-item:hover .copy-icon,
.dfn-panel .link-item .copy-icon:focus {
    opacity: 1;
}

.dfn-panel .copy-icon {
    display: inline-block;
    margin-right: 0.5em;
    width: 0.85em;
    height: 1em;
    border-radius: 3px;
    background-color: #ccc;
    cursor: pointer;
}

.dfn-panel .copy-icon .icon {
    width: 100%;
    height: 100%;
    background-color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
}

.dfn-panel .copy-icon .icon::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 1px solid black;
    background-color: #ccc;
    opacity: 0.25;
    transform: translate(3px, -3px);
}

.dfn-panel .copy-icon:active .icon::before {
    opacity: 1;
}

.dfn-paneled[role="button"] { cursor: help; }

.highlighted {
    animation: target-fade 3s;
}

@keyframes target-fade {
    from {
        background-color: var(--dfnpanel-target-bg);
        outline: 5px solid var(--dfnpanel-target-outline);
    }
    to {
        color: var(--a-normal-text);
        background-color: transparent;
        outline: transparent;
    }
}
</style>
<style>/* Boilerplate: style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* Boilerplate: style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* Boilerplate: style-mdn-anno */
:root {
	--mdn-bg: #EEE;
	--mdn-shadow: #999;
	--mdn-nosupport-text: #ccc;
	--mdn-pass: green;
	--mdn-fail: red;
}
@media (prefers-color-scheme: dark) {
	:root {
		--mdn-bg: #222;
		--mdn-shadow: #444;
		--mdn-nosupport-text: #666;
		--mdn-pass: #690;
		--mdn-fail: #d22;
	}
}
.mdn-anno {
	background: var(--mdn-bg, #EEE);
	border-radius: .25em;
	box-shadow: 0 0 3px var(--mdn-shadow, #999);
	color: var(--text, black);
	font: 1em sans-serif;
	hyphens: none;
	max-width: min-content;
	overflow: hidden;
	padding: 0.2em;
	position: absolute;
	right: 0.3em;
	top: auto;
	white-space: nowrap;
	word-wrap: normal;
	z-index: 8;
}
.mdn-anno.unpositioned {
	display: none;
}
.mdn-anno.overlapping-main {
	opacity: .2;
	transition: opacity .1s;
}
.mdn-anno[open] {
	opacity: 1;
	z-index: 9;
	min-width: 9em;
}
.mdn-anno:hover {
	opacity: 1;
	outline: var(--text, black) 1px solid;
}
.mdn-anno > summary {
	font-weight: normal;
	text-align: right;
	cursor: pointer;
	display: block;
}
.mdn-anno > summary > .less-than-two-engines-flag {
	color: var(--mdn-fail);
	padding-right: 2px;
}
.mdn-anno > summary > .all-engines-flag {
	color: var(--mdn-pass);
	padding-right: 2px;
}
.mdn-anno > summary > span {
	color: #fff;
	background-color: #000;
	font-weight: normal;
	font-family: zillaslab, Palatino, "Palatino Linotype", serif;
	padding: 2px 3px 0px 3px;
	line-height: 1.3em;
	vertical-align: top;
}
.mdn-anno > .feature {
	margin-top: 20px;
}
.mdn-anno > .feature:not(:first-of-type) {
	border-top: 1px solid #999;
	margin-top: 6px;
	padding-top: 2px;
}
.mdn-anno > .feature > .less-than-two-engines-text {
	color: var(--mdn-fail);
}
.mdn-anno > .feature > .all-engines-text {
	color: var(--mdn-pass);
}
.mdn-anno > .feature > p {
	font-size: .75em;
	margin-top: 6px;
	margin-bottom: 0;
}
.mdn-anno > .feature > p + p {
	margin-top: 3px;
}
.mdn-anno > .feature > .support {
	display: block;
	font-size: 0.6em;
	margin: 0;
	padding: 0;
	margin-top: 2px;
}
.mdn-anno > .feature > .support + div {
	padding-top: 0.5em;
}
.mdn-anno > .feature > .support > hr {
	display: block;
	border: none;
	border-top: 1px dotted #999;
	padding: 3px 0px 0px 0px;
	margin: 2px 3px 0px 3px;
}
.mdn-anno > .feature > .support > hr::before {
	content: "";
}
.mdn-anno > .feature > .support > span {
	padding: 0.2em 0;
	display: block;
	display: table;
}
.mdn-anno > .feature > .support > span.no {
	color: var(--mdn-nosupport-text);
	filter: grayscale(100%);
}
.mdn-anno > .feature > .support > span.no::before {
	opacity: 0.5;
}
.mdn-anno > .feature > .support > span:first-of-type {
	padding-top: 0.5em;
}
.mdn-anno > .feature > .support > span > span {
	padding: 0 0.5em;
	display: table-cell;
}
.mdn-anno > .feature > .support > span > span:first-child {
	width: 100%;
}
.mdn-anno > .feature > .support > span > span:last-child {
	width: 100%;
	white-space: pre;
	padding: 0;
}
.mdn-anno > .feature > .support > span::before {
	content: ' ';
	display: table-cell;
	min-width: 1.5em;
	height: 1.5em;
	background: no-repeat center center;
	background-size: contain;
	text-align: right;
	font-size: 0.75em;
	font-weight: bold;
}
.mdn-anno > .feature > .support > .chrome_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/chrome.svg);
}
.mdn-anno > .feature > .support > .firefox_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/firefox.png);
}
.mdn-anno > .feature > .support > .chrome::before {
	background-image: url(https://resources.whatwg.org/browser-logos/chrome.svg);
}
.mdn-anno > .feature > .support > .edge_blink::before {
	background-image: url(https://resources.whatwg.org/browser-logos/edge.svg);
}
.mdn-anno > .feature > .support > .edge::before {
	background-image: url(https://resources.whatwg.org/browser-logos/edge_legacy.svg);
}
.mdn-anno > .feature > .support > .firefox::before {
	background-image: url(https://resources.whatwg.org/browser-logos/firefox.png);
}
.mdn-anno > .feature > .support > .ie::before {
	background-image: url(https://resources.whatwg.org/browser-logos/ie.png);
}
.mdn-anno > .feature > .support > .safari_ios::before {
	background-image: url(https://resources.whatwg.org/browser-logos/safari-ios.svg);
}
.mdn-anno > .feature > .support > .nodejs::before {
	background-image: url(https://nodejs.org/favicon.ico);
}
.mdn-anno > .feature > .support > .opera_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/opera.svg);
}
.mdn-anno > .feature > .support > .opera::before {
	background-image: url(https://resources.whatwg.org/browser-logos/opera.svg);
}
.mdn-anno > .feature > .support > .safari::before {
	background-image: url(https://resources.whatwg.org/browser-logos/safari.png);
}
.mdn-anno > .feature > .support > .samsunginternet_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/samsung.svg);
}
.mdn-anno > .feature > .support > .webview_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/android-webview.png);
}
.name-slug-mismatch {
	color: red;
}
.caniuse-status:hover {
	z-index: 9;
}
/* dt, li, .issue, .note, and .example are "position: relative", so to put annotation at right margin, must move to right of containing block */;
.h-entry:not(.status-LS) dt > .mdn-anno, .h-entry:not(.status-LS) li > .mdn-anno, .h-entry:not(.status-LS) .issue > .mdn-anno, .h-entry:not(.status-LS) .note > .mdn-anno, .h-entry:not(.status-LS) .example > .mdn-anno {
	right: -6.7em;
}
.h-entry p + .mdn-anno {
	margin-top: 0;
}
 h2 + .mdn-anno.after {
	margin: -48px 0 0 0;
}
 h3 + .mdn-anno.after {
	margin: -46px 0 0 0;
}
 h4 + .mdn-anno.after {
	margin: -42px 0 0 0;
}
 h5 + .mdn-anno.after {
	margin: -40px 0 0 0;
}
 h6 + .mdn-anno.after {
	margin: -40px 0 0 0;
}
</style>
<style>/* Boilerplate: style-ref-hints */
:root {
    --ref-hint-bg: #ddd;
    --ref-hint-text: var(--text);
}
@media (prefers-color-scheme: dark) {
    :root {
        --ref-hint-bg: #222;
        --ref-hint-text: var(--text);
    }
}

.ref-hint {
    display: inline-block;
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.5em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--ref-hint-bg);
    color: var(--ref-hint-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}

.ref-hint * { margin: 0; padding: 0; text-indent: 0; }

.ref-hint ul { padding: 0 0 0 1em; list-style: none; }
</style>
<style>/* Boilerplate: style-selflinks */
:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* Boilerplate: style-syntax-highlighting */
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */

@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">Network Error Logging</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types/#ED">Editor’s Draft</a>, <time class="dt-updated" datetime="2026-01-06">6 January 2026</time></p>
   <details open>
    <summary>More details about this document</summary>
    <div data-fill-with="spec-metadata">
     <dl>
      <dt>This version:
      <dd><a class="u-url" href="https://w3c.github.io/network-error-logging/">https://w3c.github.io/network-error-logging/</a>
      <dt>Issue Tracking:
      <dd><a href="https://github.com/w3c/network-error-logging/issues/">GitHub</a>
      <dd><a href="#issues-index">Inline In Spec</a>
      <dt class="editor">Editors:
      <dd class="editor p-author h-card vcard" data-editor-id="103120"><a class="p-name fn u-url url" href="https://dcreager.net/">Douglas Creager</a> (<span class="p-org org">GitHub</span>)
      <dd class="editor p-author h-card vcard" data-editor-id="76841"><span class="p-name fn">Ian Clelland</span> (<span class="p-org org">Google</span>)
      <dt class="editor">Former Editors:
      <dd class="editor p-author h-card vcard"><a class="p-name fn u-url url" href="https://www.igvita.com/">Ilya Grigorik</a> (<span class="p-org org">Google</span>)
      <dd class="editor p-author h-card vcard"><span class="p-name fn">Julia Tuttle</span> (<span class="p-org org">Google</span>)
      <dd class="editor p-author h-card vcard"><span class="p-name fn">Arvind Jain</span> (<span class="p-org org">Google</span>)
      <dd class="editor p-author h-card vcard"><span class="p-name fn">Alois Reitbauer</span> (<span class="p-org org">Compuware Corp.</span>)
      <dd class="editor p-author h-card vcard"><span class="p-name fn">Jatinder Mann</span> (<span class="p-org org">Microsoft</span>)
     </dl>
    </div>
   </details>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/policies/#copyright">Copyright</a> © 2026 <a href="https://www.w3.org/">World Wide Web Consortium</a>. <abbr title="World Wide Web Consortium">W3C</abbr><sup>®</sup> <a href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/copyright/software-license/" rel="license" title="W3C Software and Document License">permissive document license</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This document defines a mechanism that enables developers to declare a network error reporting policy for a web application. A user agent can use this policy to report encountered network errors that prevented it from successfully fetching requested resources.</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This is a public copy of the editors’ draft.
	It is provided for discussion only and may change at any moment.
	Its publication here does not imply endorsement of its contents by W3C.
	Don’t cite this document other than as work in progress. </p>
   <p><a href="https://github.com/w3c/network-error-logging/issues">GitHub Issues</a> are preferred for discussion of this specification. </p>
   <p>This document is governed by the <a href="https://www.w3.org/policies/process/20250818/" id="w3c_process_revision">18 August 2025 W3C Process Document</a>. </p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#introduction"><span class="secno">1</span> <span class="content">Introduction</span></a>
    <li><a href="#conformance"><span class="secno">2</span> <span class="content">Conformance</span></a>
    <li>
     <a href="#concepts"><span class="secno">3</span> <span class="content">Concepts</span></a>
     <ol class="toc">
      <li><a href="#network-requests"><span class="secno">3.1</span> <span class="content">Network requests</span></a>
      <li><a href="#concept-network-errors"><span class="secno">3.2</span> <span class="content">Network errors</span></a>
      <li><a href="#concept-network-error-reports"><span class="secno">3.3</span> <span class="content">Network error reports</span></a>
      <li><a href="#concept-nel-policies"><span class="secno">3.4</span> <span class="content">NEL policies</span></a>
      <li><a href="#sampling-rates"><span class="secno">3.5</span> <span class="content">Sampling rates</span></a>
      <li><a href="#concept-policy-cache"><span class="secno">3.6</span> <span class="content">Policy cache</span></a>
     </ol>
    <li>
     <a href="#policy-delivery"><span class="secno">4</span> <span class="content">Policy delivery</span></a>
     <ol class="toc">
      <li>
       <a href="#nel-response-header"><span class="secno">4.1</span> <span class="content"><code>NEL</code> response header</span></a>
       <ol class="toc">
        <li><a href="#report-to-member"><span class="secno">4.1.1</span> <span class="content">The <code>report_to</code> member</span></a>
        <li><a href="#max-age-member"><span class="secno">4.1.2</span> <span class="content">The <code>max_age</code> member</span></a>
        <li><a href="#include-subdomains-member"><span class="secno">4.1.3</span> <span class="content">The <code>include_subdomains</code> member</span></a>
        <li><a href="#success-fraction-member"><span class="secno">4.1.4</span> <span class="content">The <code>success_fraction</code> member</span></a>
        <li><a href="#failure-fraction-member"><span class="secno">4.1.5</span> <span class="content">The <code>failure_fraction</code> member</span></a>
       </ol>
      <li><a href="#process-policy-headers"><span class="secno">4.2</span> <span class="content">Process policy headers</span></a>
     </ol>
    <li>
     <a href="#report-delivery"><span class="secno">5</span> <span class="content">Report delivery</span></a>
     <ol class="toc">
      <li><a href="#choose-a-policy-for-a-request"><span class="secno">5.1</span> <span class="content">Choose a policy for a request</span></a>
      <li><a href="#generate-a-network-error-report"><span class="secno">5.2</span> <span class="content">Generate a network error report</span></a>
      <li><a href="#deliver-a-network-report"><span class="secno">5.3</span> <span class="content">Deliver a network report</span></a>
     </ol>
    <li>
     <a href="#predefined-network-error-types"><span class="secno">6</span> <span class="content">Predefined network error types</span></a>
     <ol class="toc">
      <li><a href="#dns-resolution-errors"><span class="secno">6.1</span> <span class="content">DNS resolution errors</span></a>
      <li><a href="#secure-connection-establishment-errors"><span class="secno">6.2</span> <span class="content">Secure connection establishment errors</span></a>
      <li><a href="#transmission-errors"><span class="secno">6.3</span> <span class="content">Transmission of request and response errors</span></a>
     </ol>
    <li>
     <a href="#examples"><span class="secno">7</span> <span class="content">Examples</span></a>
     <ol class="toc">
      <li><a href="#sample-policy-definitions"><span class="secno">7.1</span> <span class="content">Sample Policy Definitions</span></a>
      <li><a href="#sample-network-error-reports"><span class="secno">7.2</span> <span class="content">Sample Network Error Reports</span></a>
      <li><a href="#dns-misconfiguration"><span class="secno">7.3</span> <span class="content">DNS misconfiguration</span></a>
      <li><a href="#origins-with-multiple-ip-addresses"><span class="secno">7.4</span> <span class="content">Origins with multiple IP addresses</span></a>
     </ol>
    <li>
     <a href="#use-cases"><span class="secno">8</span> <span class="content">Use cases</span></a>
     <ol class="toc">
      <li><a href="#reporting-navigation-failures"><span class="secno">8.1</span> <span class="content">Reporting of Navigation Failures</span></a>
      <li><a href="#reporting-first-party-subresource-failures"><span class="secno">8.2</span> <span class="content">Reporting of First-party Subresource Fetch Failures</span></a>
      <li><a href="#reporting-third-party-subresource-failures"><span class="secno">8.3</span> <span class="content">Reporting of Third-party Subresource Fetch Failures</span></a>
     </ol>
    <li><a href="#privacy-considerations"><span class="secno">9</span> <span class="content">Privacy Considerations</span></a>
    <li>
     <a href="#iana-considerations"><span class="secno">10</span> <span class="content">IANA Considerations</span></a>
     <ol class="toc">
      <li><a href="#iana-nel"><span class="secno">10.1</span> <span class="content"><code>NEL</code></span></a>
     </ol>
    <li><a href="#acknowledgments"><span class="secno">11</span> <span class="content">Acknowledgments</span></a>
    <li>
     <a href="#w3c-conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ol class="toc">
      <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#w3c-conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="introduction"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#introduction"></a></h2>
   <p>Accurately measuring performance characteristics of web applications is an important aspect in helping site developers understand how to improve their web applications. The worst case scenario is the failure to load the application, or a particular resource, due to a network error, and to address such failures the developer requires assistance from the user agent to identify when, where, and why such failures are occurring.</p>
   <p>Today, application developers do not have real-time web application availability data from their end users. For example, if the user fails to load the page due to a network error, such as a failed DNS lookup, a connection timeout, a reset connection, or other reasons, the site developer is unable to detect and address this issue. Note that these kinds of network errors cannot be detected purely server-side, since by definition the client might not have been able to successfully establish a connection with the server.</p>
   <p>Existing methods (such as synthetic monitoring) provide a partial solution by placing monitoring nodes in predetermined geographic locations, but require additional infrastructure investments, and cannot provide truly global and near real-time availability data for real end users.</p>
   <p>Network Error Logging (NEL) addresses this need by defining a mechanism enabling web applications to declare a reporting policy that can be used by the user agent to report network errors for a given origin. A web application opts into using NEL by supplying a <a data-link-type="dfn" href="#nel" id="ref-for-nel">NEL</a> HTTP response header field that describes the desired <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies">NEL policy</a>. This policy instructs the user agent to log information about requests to that origin, and to attempt to deliver that information to a group of endpoints previously configured using the <a data-link-type="biblio" href="#biblio-reporting" title="Reporting API">[REPORTING]</a>. As the name implies, NEL reports are primarily used to describe <em>errors</em>. However, in order to determine <em>rates</em> of errors across different client populations, we must also know how many <em>successful</em> requests are occurring; these successful requests can also be reported via the NEL mechanism.</p>
   <p>For example, if the user agent fails to fetch a resource from <code>https://www.example.com</code> due to an aborted TCP connection, the user agent would queue the following report via the Reporting API:</p>
   <dl>
    <dt data-md>type
    <dd data-md>
     <p><code>"network-error"</code></p>
    <dt data-md>endpoint group
    <dd data-md>
     <p>the endpoint group configured by the <a data-link-type="dfn" href="#report_to" id="ref-for-report_to">report_to</a> field</p>
    <dt data-md>data
    <dd data-md>
<pre class="highlight"><c- p>{</c->
  <c- f>"referrer"</c-><c- p>:</c-> <c- u>"https://referrer.com/"</c-><c- p>,</c->
  <c- f>"sampling_fraction"</c-><c- p>:</c-> <c- mf>1.0</c-><c- p>,</c->
  <c- f>"server_ip"</c-><c- p>:</c-> <c- u>"192.0.2.42"</c-><c- p>,</c->
  <c- f>"protocol"</c-><c- p>:</c-> <c- u>"http/1.1"</c-><c- p>,</c->
  <c- f>"elapsed_time"</c-><c- p>:</c-> <c- mi>321</c-><c- p>,</c->
  <c- f>"phase"</c-><c- p>:</c-> <c- u>"connection"</c-><c- p>,</c->
  <c- f>"type"</c-><c- p>:</c-> <c- u>"tcp.aborted"</c->
<c- p>}</c->
</pre>
   </dl>
   <p>See <a href="#generate-a-network-error-report">§ 5.2 Generate a network error report</a> for an explanation of the communicated fields and format of the report, and <a href="#examples">§ 7 Examples</a> for more hands-on examples of NEL registration and reporting process.</p>
   <h2 class="heading settled" data-level="2" id="conformance"><span class="secno">2. </span><span class="content">Conformance</span><a class="self-link" href="#conformance"></a></h2>
   <p>Requirements phrased in the imperative as part of algorithms (such as "strip any leading space characters" or "return false and abort these steps") are to be interpreted with the meaning of the key word ("must", "should", "may", etc) used in introducing the algorithm.</p>
   <p>Some conformance requirements are phrased as requirements on attributes, methods or objects. Such requirements are to be interpreted as requirements on the user agent.</p>
   <p>Conformance requirements phrased as algorithms or specific steps may be implemented in any manner, so long as the end result is equivalent. (In particular, the algorithms defined in this specification are intended to be easy to follow, and not intended to be performant.)</p>
   <h2 class="heading settled" data-level="3" id="concepts"><span class="secno">3. </span><span class="content">Concepts</span><a class="self-link" href="#concepts"></a></h2>
   <h3 class="heading settled" data-level="3.1" id="network-requests"><span class="secno">3.1. </span><span class="content">Network requests</span><a class="self-link" href="#network-requests"></a></h3>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="network-request">network request</dfn> occurs when the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent">user agent</a> attempts to <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#http-network-fetch" id="ref-for-http-network-fetch">HTTP-network fetch</a> a resource over the network for a given <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request">request</a>.</p>
   <p>A <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①">request</a> MUST NOT result in a <a data-link-type="dfn" href="#network-request" id="ref-for-network-request">network request</a> if the user agent is known to be offline (i.e., when <code>navigator.</code><code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/system-state.html#dom-navigator-online" id="ref-for-dom-navigator-online">onLine</a></code> returns <code>false</code>).</p>
   <p>A <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request②">request</a> MUST NOT result in a <a data-link-type="dfn" href="#network-request" id="ref-for-network-request①">network request</a> if it is blocked due to <a data-link-type="dfn" href="https://w3c.github.io/webappsec-mixed-content/#mixed-content" id="ref-for-mixed-content">mixed content</a> or <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#cors-protocol" id="ref-for-cors-protocol">CORS</a> failures. Any <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#cors-preflight-request" id="ref-for-cors-preflight-request">CORS-preflight request</a> MUST result in its own <a data-link-type="dfn" href="#network-request" id="ref-for-network-request②">network request</a>.</p>
   <p class="note" role="note"><span class="marker">Note:</span> For user agents that service <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request③">requests</a> according to the <a data-link-type="biblio" href="#biblio-fetch" title="Fetch Standard">[FETCH]</a> standard, a <a data-link-type="dfn" href="#network-request" id="ref-for-network-request③">network request</a> corresponds to one execution of the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#http-network-fetch" id="ref-for-http-network-fetch①">HTTP-network fetch</a> algorithm.</p>
   <p>Regardless of which fetch algorithm and which underlying application and transport protocols are used, servicing a <a data-link-type="dfn" href="#network-request" id="ref-for-network-request④">network request</a> consists of the following <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="phase" data-noexport id="phase">phases</dfn>:</p>
   <ol>
    <li data-md>
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="dns-resolution">DNS resolution</dfn>: The user agent uses the Domain Name System <a data-link-type="biblio" href="#biblio-rfc1034" title="Domain names - concepts and facilities">[RFC1034]</a> to resolve a domain name into an <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-host-ip-address" id="ref-for-concept-host-ip-address">IP address</a> of a <dfn class="dfn-paneled" data-cite="RFC9110#core.semantics" data-dfn-type="dfn" data-noexport id="server">server</dfn> that can service HTTP <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request④">requests</a> to that domain.</p>
    <li data-md>
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="secure-connection-establishment">Secure connection establishment</dfn>: The user agent opens a connection to the <a data-link-type="dfn" href="#server" id="ref-for-server">server</a>, and establishes a secure channel over this connection.</p>
    <li data-md>
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="transmission-of-request-and-response">Transmission of request and response</dfn>: Once the secure channel is established, the user agent can transmit the HTTP <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑤">request</a>, and receive the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response">response</a> from the <a data-link-type="dfn" href="#server" id="ref-for-server①">server</a>.</p>
   </ol>
   <p>The only mandatory <a data-link-type="dfn" href="#phase" id="ref-for-phase">phase</a> is the <a data-link-type="dfn" href="#transmission-of-request-and-response" id="ref-for-transmission-of-request-and-response">transmission of request and response</a>; the other <a data-link-type="dfn" href="#phase" id="ref-for-phase①">phases</a> might not be needed for every <a data-link-type="dfn" href="#network-request" id="ref-for-network-request⑤">network request</a>. For instance, DNS results can be cached locally in the user agent, eliminating <a data-link-type="dfn" href="#dns-resolution" id="ref-for-dns-resolution">DNS resolution</a> for future requests to the same domain. Similarly, HTTP persistent connections <a data-link-type="biblio" href="#biblio-rfc9112" title="HTTP/1.1">[RFC9112]</a> allow open connections to be shared for multiple requests to the same <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#network-partition-key" id="ref-for-network-partition-key">network partition key</a>. However, if multiple <a data-link-type="dfn" href="#phase" id="ref-for-phase②">phases</a> occur, they will occur in the above order.</p>
   <p class="issue" id="issue-95f7f578"><a class="self-link" href="#issue-95f7f578"></a> We would like to move the definition of these <a data-link-type="dfn" href="#phase" id="ref-for-phase③">phases</a> into <a data-link-type="biblio" href="#biblio-fetch" title="Fetch Standard">[FETCH]</a> so that they are more reusable.</p>
   <p>A <a data-link-type="dfn" href="#network-request" id="ref-for-network-request⑥">network request</a> is <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-lt="succeed|succeeded|successful" id="succeed">successful</dfn> if the user agent is able to receive a valid HTTP response from the server, and that response does not have a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="4xx">4xx</dfn> or <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="5xx">5xx</dfn> status code.</p>
   <p>A <a data-link-type="dfn" href="#network-request" id="ref-for-network-request⑦">network request</a> is <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="fail|failures" data-noexport id="fail">failed</dfn> if it is not <a data-link-type="dfn" href="#succeed" id="ref-for-succeed">successful</a>.</p>
   <p class="note" role="note"><span class="marker">Note:</span> Note that HTTP error responses (i.e., those with a <a data-link-type="dfn" href="#4xx" id="ref-for-4xx">4xx</a> or <a data-link-type="dfn" href="#5xx" id="ref-for-5xx">5xx</a> status code) are considered <a data-link-type="dfn" href="#fail" id="ref-for-fail">failures</a>, so that they are subject to a <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies①">NEL policy</a>’s <a data-link-type="dfn" href="#failure-sampling-rate" id="ref-for-failure-sampling-rate">failure sampling rate</a> instead of its <a data-link-type="dfn" href="#successful-sampling-rate" id="ref-for-successful-sampling-rate">successful sampling rate</a>.</p>
   <h3 class="heading settled" data-level="3.2" id="concept-network-errors"><span class="secno">3.2. </span><span class="content">Network errors</span><a class="self-link" href="#concept-network-errors"></a></h3>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="network errors" data-noexport id="network-errors">network error</dfn> is the error condition that caused a <a data-link-type="dfn" href="#network-request" id="ref-for-network-request⑧">network request</a> to <a data-link-type="dfn" href="#fail" id="ref-for-fail①">fail</a>.</p>
   <p>Each <a data-link-type="dfn" href="#network-errors" id="ref-for-network-errors">network error</a> has a <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="types" data-noexport id="types">type</dfn>, which is a string.</p>
   <p>Each <a data-link-type="dfn" href="#network-errors" id="ref-for-network-errors①">network error</a> has a <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="type-phase" data-noexport id="type-phase">phase</dfn>, which describes which <a data-link-type="dfn" href="#phase" id="ref-for-phase④">phase</a> the error occurred in:</p>
   <dl>
    <dt data-md><code>dns</code>
    <dd data-md>
     <p>the error occurred during <a data-link-type="dfn" href="#dns-resolution" id="ref-for-dns-resolution①">DNS resolution</a></p>
    <dt data-md><code>connection</code>
    <dd data-md>
     <p>the error occurred during <a data-link-type="dfn" href="#secure-connection-establishment" id="ref-for-secure-connection-establishment">secure connection establishment</a></p>
    <dt data-md><code>application</code>
    <dd data-md>
     <p>the error occurred during the <a data-link-type="dfn" href="#transmission-of-request-and-response" id="ref-for-transmission-of-request-and-response①">transmission of request and response</a></p>
   </dl>
   <p>There are several predefined <a data-link-type="dfn" href="#network-errors" id="ref-for-network-errors②">network error</a> <a data-link-type="dfn" href="#types" id="ref-for-types">types</a> defined in <a href="#predefined-network-error-types">§ 6 Predefined network error types</a>.</p>
   <h3 class="heading settled" data-level="3.3" id="concept-network-error-reports"><span class="secno">3.3. </span><span class="content">Network error reports</span><a class="self-link" href="#concept-network-error-reports"></a></h3>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="network error reports" data-noexport id="network-error-reports">network error report</dfn> is a <a data-link-type="biblio" href="#biblio-reporting" title="Reporting API">[REPORTING]</a> <a data-link-type="dfn" href="https://w3c.github.io/reporting/#concept-report" id="ref-for-concept-report">report</a> that describes a <a data-link-type="dfn" href="#network-errors" id="ref-for-network-errors③">network error</a>.</p>
   <p><a data-link-type="dfn" href="#network-error-reports" id="ref-for-network-error-reports">Network error reports</a> have a <a data-link-type="dfn" href="https://w3c.github.io/reporting/#report-type" id="ref-for-report-type">report type</a> of <code>network-error</code>.</p>
   <p><a data-link-type="dfn" href="#network-error-reports" id="ref-for-network-error-reports①">Network error reports</a> are <strong>NOT</strong> <a data-link-type="dfn" href="https://w3c.github.io/reporting/#visible-to-reportingobservers" id="ref-for-visible-to-reportingobservers">visible to ReportingObservers</a>.</p>
   <p class="note" role="note"><span class="marker">Note:</span> <a data-link-type="dfn" href="#network-error-reports" id="ref-for-network-error-reports②">Network error reports</a> are not <a data-link-type="dfn" href="https://w3c.github.io/reporting/#visible-to-reportingobservers" id="ref-for-visible-to-reportingobservers①">visible to ReportingObservers</a> because they are only intended to be visible to the administrator or owner of the server <em>receiving</em> the requests. If they were <a data-link-type="dfn" href="https://w3c.github.io/reporting/#visible-to-reportingobservers" id="ref-for-visible-to-reportingobservers②">visible to ReportingObservers</a>, then the reports would also be visible to the <em>originator</em> of the request. For cross-origin requests, this could leak information about the server’s network configuration to parties outside of its control.</p>
   <h3 class="heading settled" data-level="3.4" id="concept-nel-policies"><span class="secno">3.4. </span><span class="content">NEL policies</span><a class="self-link" href="#concept-nel-policies"></a></h3>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-lt="NEL policies|NEL policy" id="nel-policies">NEL policy</dfn> instructs a user agent whether to collect reports about <a data-link-type="dfn" href="#network-request" id="ref-for-network-request⑨">network requests</a> to an <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-origin" id="ref-for-concept-request-origin">origin</a>, and if so, where to send them. <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies②">NEL policies</a> are delivered to the user agent via HTTP <dfn class="dfn-paneled" data-cite="RFC9110#fields" data-dfn-type="dfn" data-noexport id="response-headers">response headers</dfn>.</p>
   <p>Each <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies③">NEL policy</a> has a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="received-ip-address">received IP address</dfn>, which is the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-host-ip-address" id="ref-for-concept-host-ip-address①">IP address</a> of the <a data-link-type="dfn" href="#server" id="ref-for-server②">server</a> that the user agent received this <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies④">NEL policy</a> from.</p>
   <p>Each <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies⑤">NEL policy</a> has an <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="policy origin" data-noexport id="policy-origin">origin</dfn>.</p>
   <p>Each <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies⑥">NEL policy</a> has a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="subdomains">subdomains</dfn> flag, which is either <code>include</code> or <code>exclude</code>.</p>
   <p>Each <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies⑦">NEL policy</a> has a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="reporting-group">reporting group</dfn>, which is the name of the Reporting <a data-link-type="dfn" href="https://w3c.github.io/reporting/#endpoint-group" id="ref-for-endpoint-group">endpoint group</a> that reports for this policy will be sent to.</p>
   <p>Each <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies⑧">NEL policy</a> has a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="ttl">ttl</dfn> representing the number of seconds the policy remains valid.</p>
   <p>Each <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies⑨">NEL policy</a> has a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="creation">creation</dfn> which is the timestamp when the user agent received the policy.</p>
   <p>A <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies①⓪">NEL policy</a> is <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="stale">stale</dfn> if the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-duration-from" id="ref-for-dfn-duration-from">duration from</a> its <a data-link-type="dfn" href="#creation" id="ref-for-creation">creation</a> to the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-wall-clock" id="ref-for-dfn-wall-clock">wall clock</a>’s <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-unsafe-current-time" id="ref-for-dfn-unsafe-current-time">unsafe current time</a> is greater than 172800 seconds (48 hours).</p>
   <p>A <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies①①">NEL policy</a> is <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="expired">expired</dfn> if the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-duration-from" id="ref-for-dfn-duration-from①">duration from</a> its <a data-link-type="dfn" href="#creation" id="ref-for-creation①">creation</a> to the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-wall-clock" id="ref-for-dfn-wall-clock①">wall clock</a>’s <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-unsafe-current-time" id="ref-for-dfn-unsafe-current-time①">unsafe current time</a> is greater than its <a data-link-type="dfn" href="#ttl" id="ref-for-ttl">ttl</a> (in seconds).</p>
   <h3 class="heading settled" data-level="3.5" id="sampling-rates"><span class="secno">3.5. </span><span class="content">Sampling rates</span><a class="self-link" href="#sampling-rates"></a></h3>
   <p>An <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-origin" id="ref-for-concept-request-origin①">origin</a> that expects to serve a large volume of traffic might not be equipped to ingest NEL reports for every <a data-link-type="dfn" href="#network-request" id="ref-for-network-request①⓪">network request</a> made to the origin. The origin can define <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="sampling rate" data-noexport id="sampling-rate">sampling rates</dfn> to limit the number of NEL reports that each user agent submits. Since <a data-link-type="dfn" href="#succeed" id="ref-for-succeed①">successful</a> requests should typically greatly outnumber <a data-link-type="dfn" href="#fail" id="ref-for-fail②">failed</a> requests, the origin can specify different sampling rates for each.</p>
   <p>Each <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies①②">NEL policy</a> has a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="successful-sampling-rate">successful sampling rate</dfn>, which is a number between 0.0 and 1.0 inclusive.</p>
   <p>Each <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies①③">NEL policy</a> has a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="failure-sampling-rate">failure sampling rate</dfn>, which is a number between 0.0 and 1.0 inclusive.</p>
   <h3 class="heading settled" data-level="3.6" id="concept-policy-cache"><span class="secno">3.6. </span><span class="content">Policy cache</span><a class="self-link" href="#concept-policy-cache"></a></h3>
   <p>A conformant user agent MUST provide a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="policy-cache">policy cache</dfn>, which is a storage mechanism that maintains a set of <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies①④">NEL policies</a>, keyed by (<a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#network-partition-key" id="ref-for-network-partition-key①">network partition key</a>, <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-origin" id="ref-for-concept-request-origin②">origin</a>) tuples.</p>
   <p>This storage mechanism is opaque, vendor-specific, and not exposed to the web, but it MUST provide the following methods which will be used in the algorithms this document defines:</p>
   <ul>
    <li data-md>
     <p>Insert, update, and delete <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies①⑤">NEL policies</a>.</p>
    <li data-md>
     <p>Retrieve the <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies①⑥">NEL policy</a>, if any, for a given <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-origin" id="ref-for-concept-request-origin③">origin</a> and <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#network-partition-key" id="ref-for-network-partition-key②">network partition key</a>.</p>
    <li data-md>
     <p>Clear the cache.</p>
   </ul>
   <h2 class="heading settled" data-level="4" id="policy-delivery"><span class="secno">4. </span><span class="content">Policy delivery</span><a class="self-link" href="#policy-delivery"></a></h2>
   <p>A <a data-link-type="dfn" href="#server" id="ref-for-server③">server</a> MAY define a <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies①⑦">NEL policy</a> for an origin it controls via the <a data-link-type="dfn" href="#nel" id="ref-for-nel①">NEL</a> HTTP <a data-link-type="dfn" href="#response-headers" id="ref-for-response-headers">response header</a>.</p>
   <h3 class="heading settled" data-level="4.1" id="nel-response-header"><span class="secno">4.1. </span><span class="content"><code>NEL</code> response header</span><a class="self-link" href="#nel-response-header"></a></h3>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="nel"><code>NEL</code></dfn> <a data-link-type="dfn" href="#response-headers" id="ref-for-response-headers①">response header</a> is used to communicate an <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-origin" id="ref-for-concept-request-origin④">origin</a>’s <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies①⑧">NEL policy</a> to the user agent. The ABNF (Augmented Backus-Naur Form) <a data-link-type="biblio" href="#biblio-rfc5234" title="Augmented BNF for Syntax Specifications: ABNF">[RFC5234]</a> syntax for the <a data-link-type="dfn" href="#nel" id="ref-for-nel②">NEL</a> header is as follows:</p>
<pre>NEL = json-field-value
</pre>
   <p>The header’s value is interpreted as an array of JSON objects, as defined by <a data-link-type="biblio" href="#biblio-rfc9651" title="Structured Field Values for HTTP">[RFC9651]</a>. Each object in the array defines an <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies①⑨">NEL policy</a> for the origin. The user agent MUST process the first valid policy in the array and ignore any additional policies in the array.</p>
   <p>User agents MUST ignore any unknown or invalid field(s) or value(s) that do not conform to the syntax defined in this specification. A valid <a data-link-type="dfn" href="#nel" id="ref-for-nel③">NEL</a> header field MUST, at a minimum, contain one object with all of the "REQUIRED" fields defined in this specification.</p>
   <p>The user agent MUST ignore the <a data-link-type="dfn" href="#nel" id="ref-for-nel④">NEL</a> header specified via a <code>meta</code> element to mitigate hijacking of error reporting via scripting attacks. The <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies②⓪">NEL policy</a> MUST be delivered via the <a data-link-type="dfn" href="#nel" id="ref-for-nel⑤">NEL</a> <a data-link-type="dfn" href="#response-headers" id="ref-for-response-headers②">response header</a>.</p>
   <p class="note" role="note"><span class="marker">Note:</span> The restriction on <code>meta</code> element is consistent with the <a data-link-type="biblio" href="#biblio-csp" title="Content Security Policy Level 3">[CSP]</a> specification, which restricts reporting registration to HTTP header fields only for the same reasons.</p>
   <h4 class="heading settled" data-level="4.1.1" id="report-to-member"><span class="secno">4.1.1. </span><span class="content">The <code>report_to</code> member</span><a class="self-link" href="#report-to-member"></a></h4>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="report_to"><code>report_to</code></dfn> member specifies the <a data-link-type="dfn" href="https://w3c.github.io/reporting/#endpoint-group" id="ref-for-endpoint-group①">endpoint group</a> that reports for this <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies②①">NEL policy</a> will be sent to. The <a data-link-type="dfn" href="#report_to" id="ref-for-report_to①">report_to</a> member is REQUIRED to register a <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies②②">NEL policy</a>, and OPTIONAL if the intent is to remove a previous registration – see <a data-link-type="dfn" href="#max_age" id="ref-for-max_age">max_age</a>. If present, its value MUST be a string; any other type will result in a parse error.</p>
   <p class="note" role="note"><span class="marker">Note:</span> To improve delivery of NEL reports, the <a data-link-type="dfn" href="#server" id="ref-for-server④">server</a> should set <code>report_to</code> to an <a data-link-type="dfn" href="https://w3c.github.io/reporting/#endpoint-group" id="ref-for-endpoint-group②">endpoint group</a> containing at least one endpoint in an alternative origin whose infrastructure is not coupled with the origin from which the resource is being fetched — otherwise network errors cannot be reported until the problem is solved, if ever — and provide multiple endpoints to provide alternatives if some endpoints are unreachable.</p>
   <h4 class="heading settled" data-level="4.1.2" id="max-age-member"><span class="secno">4.1.2. </span><span class="content">The <code>max_age</code> member</span><a class="self-link" href="#max-age-member"></a></h4>
   <p>The REQUIRED <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="max_age"><code>max_age</code></dfn> member specifies the lifetime of this <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies②③">NEL policy</a>, as a non-negative integer number of seconds. Its value MUST be an non-negative integer; any other type will result in a parse error.</p>
   <p>A value of <code>0</code> will cause any <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies②④">NEL policy</a> for this <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-origin" id="ref-for-concept-request-origin⑤">origin</a> to be removed from the <a data-link-type="dfn" href="#policy-cache" id="ref-for-policy-cache">policy cache</a>.</p>
   <p class="note" role="note"><span class="marker">Note:</span> To ensure delivery of NEL reports, the <a data-link-type="dfn" href="#server" id="ref-for-server⑤">server</a> should ensure that the Reporting <a data-link-type="dfn" href="https://w3c.github.io/reporting/#endpoint-group" id="ref-for-endpoint-group③">endpoint group</a> is also configured with a sufficiently high <code>max_age</code>. If the Reporting policy expires, NEL reports will not be delivered, even if the NEL policy has not expired.</p>
   <h4 class="heading settled" data-level="4.1.3" id="include-subdomains-member"><span class="secno">4.1.3. </span><span class="content">The <code>include_subdomains</code> member</span><a class="self-link" href="#include-subdomains-member"></a></h4>
   <p>The OPTIONAL <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="include_subdomains"><code>include_subdomains</code></dfn> member is a boolean that enables this <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies②⑤">NEL policy</a> for all subdomains of this origin (to an unlimited subdomain depth). If no member named <code>include_subdomains</code> is present in the object, or its value is not <code>true</code>, the <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies②⑥">NEL policy</a> will not be enabled for subdomains.</p>
   <p class="note" role="note"><span class="marker">Note:</span> To ensure delivery of NEL reports for subdomains, the application should ensure that the Reporting <a data-link-type="dfn" href="https://w3c.github.io/reporting/#endpoint-group" id="ref-for-endpoint-group④">endpoint group</a> is also configured with <code>include_subdomains</code> enabled. If the Reporting policy is not, and there is not a separate Reporting policy for a given subdomain, NEL reports for that subdomain will not be delivered, even if the NEL policy includes the subdomain.</p>
   <h4 class="heading settled" data-level="4.1.4" id="success-fraction-member"><span class="secno">4.1.4. </span><span class="content">The <code>success_fraction</code> member</span><a class="self-link" href="#success-fraction-member"></a></h4>
   <p>The OPTIONAL <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="success_fraction"><code>success_fraction</code></dfn> member defines the <a data-link-type="dfn" href="#sampling-rate" id="ref-for-sampling-rate">sampling rate</a> that should be applied to reports about <a data-link-type="dfn" href="#succeed" id="ref-for-succeed②">successful</a> <a data-link-type="dfn" href="#network-request" id="ref-for-network-request①①">network requests</a> for this origin. If present, its value MUST be a number between <code>0.0</code> and <code>1.0</code>, inclusive; any other value will result in a parse error. If this member is not present, the user agent will <em>not</em> collect NEL reports about <a data-link-type="dfn" href="#succeed" id="ref-for-succeed③">successful</a> <a data-link-type="dfn" href="#network-request" id="ref-for-network-request①②">network requests</a> for this origin.</p>
   <h4 class="heading settled" data-level="4.1.5" id="failure-fraction-member"><span class="secno">4.1.5. </span><span class="content">The <code>failure_fraction</code> member</span><a class="self-link" href="#failure-fraction-member"></a></h4>
   <p>The OPTIONAL <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="failure_fraction"><code>failure_fraction</code></dfn> member defines the <a data-link-type="dfn" href="#sampling-rate" id="ref-for-sampling-rate①">sampling rate</a> that should be applied to reports about <a data-link-type="dfn" href="#fail" id="ref-for-fail③">failed</a> <a data-link-type="dfn" href="#network-request" id="ref-for-network-request①③">network requests</a> for this origin. If present, its value MUST be a number between <code>0.0</code> and <code>1.0</code>, inclusive; any other value will result in a parse error. If this member is not present, the user agent will collect NEL reports about <em>all</em> <a data-link-type="dfn" href="#fail" id="ref-for-fail④">failed</a> <a data-link-type="dfn" href="#network-request" id="ref-for-network-request①④">network requests</a> for this origin.</p>
   <h3 class="heading settled" data-level="4.2" id="process-policy-headers"><span class="secno">4.2. </span><span class="content">Process policy headers</span><a class="self-link" href="#process-policy-headers"></a></h3>
   <p>Given a <a data-link-type="dfn" href="#network-request" id="ref-for-network-request①⑤">network request</a> (<var>request</var>) and its corresponding <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①">response</a> (<var>response</var>), this algorithm extracts a <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies②⑦">NEL policy</a> for <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-origin" id="ref-for-concept-request-origin⑥">origin</a>, and updates the <a data-link-type="dfn" href="#policy-cache" id="ref-for-policy-cache①">policy cache</a> accordingly.</p>
   <ol>
    <li data-md>
     <p>Abort these steps if any of the following conditions are true:</p>
     <ul>
      <li data-md>
       <p>The result of executing the "<a data-link-type="dfn" href="https://www.w3.org/TR/secure-contexts/#is-origin-trustworthy" id="ref-for-is-origin-trustworthy">Is origin potentially trustworthy?</a>" algorithm on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-origin" id="ref-for-concept-request-origin⑦">origin</a> is <strong>not</strong> <code>Potentially Trustworthy</code>.</p>
      <li data-md>
       <p><var>response</var> does not contain a <a data-link-type="dfn" href="#response-headers" id="ref-for-response-headers③">response header</a> whose name is <code>NEL</code>.</p>
     </ul>
    <li data-md>
     <p>Let <var>origin</var> be <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-origin" id="ref-for-concept-request-origin⑧">origin</a>.</p>
    <li data-md>
     <p>Let <var>key</var> be the result of calling <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#determine-the-network-partition-key" id="ref-for-determine-the-network-partition-key">determine the network partition key</a>, given <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-reserved-client" id="ref-for-concept-request-reserved-client">reserved client</a>.</p>
    <li data-md>
     <p>Let <var>header</var> be the value of the <a data-link-type="dfn" href="#response-headers" id="ref-for-response-headers④">response header</a> whose name is <code>NEL</code>.</p>
    <li data-md>
     <p>Let <var>list</var> be the result of executing the algorithm defined in Section 4 of <a data-link-type="biblio" href="#biblio-http-jfv" title="A JSON Encoding for HTTP Header Field Values">[HTTP-JFV]</a> on <var>header</var>. If that algorithm results in an error, or if <var>list</var> is empty, abort these steps.</p>
    <li data-md>
     <p>Let <var>item</var> be the first element of <var>list</var>.</p>
    <li data-md>
     <p>If <var>item</var> has no member named <a data-link-type="dfn" href="#max_age" id="ref-for-max_age①">max_age</a>, or that member’s value is not a number, abort these steps.</p>
    <li data-md>
     <p>If the value of <var>item</var>’s <a data-link-type="dfn" href="#max_age" id="ref-for-max_age②">max_age</a> member is <code>0</code>, then remove any <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies②⑧">NEL policy</a> from the <a data-link-type="dfn" href="#policy-cache" id="ref-for-policy-cache②">policy cache</a> whose <a data-link-type="dfn" href="#policy-origin" id="ref-for-policy-origin">policy origin</a> is <var>origin</var>, and skip the remaining steps.</p>
    <li data-md>
     <p>If <var>item</var> has no member named <a data-link-type="dfn" href="#report_to" id="ref-for-report_to②">report_to</a>, or that member’s value is not a string, abort these steps.</p>
    <li data-md>
     <p>If <var>item</var> has a member named <a data-link-type="dfn" href="#success_fraction" id="ref-for-success_fraction">success_fraction</a>, whose value is not a number in the range 0.0 to 1.0, inclusive, abort these steps.</p>
    <li data-md>
     <p>If <var>item</var> has a member named <a data-link-type="dfn" href="#failure_fraction" id="ref-for-failure_fraction">failure_fraction</a>, whose value is not a number in the range 0.0 to 1.0, inclusive, abort these steps.</p>
    <li data-md>
     <p>Let <var>policy</var> be a new <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies②⑨">NEL policy</a> whose properties are set as follows:</p>
     <dl>
      <dt data-md><a data-link-type="dfn" href="#received-ip-address" id="ref-for-received-ip-address">received IP address</a>
      <dd data-md>
       <p>the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-host-ip-address" id="ref-for-concept-host-ip-address②">IP address</a> of the <a data-link-type="dfn" href="#server" id="ref-for-server⑥">server</a> that the user agent received <var>response</var> from</p>
       <p class="issue" id="issue-b2720c5c"><a class="self-link" href="#issue-b2720c5c"></a> Plumb this through more explicitly in <a data-link-type="biblio" href="#biblio-fetch" title="Fetch Standard">[FETCH]</a>.</p>
      <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-origin" id="ref-for-concept-request-origin⑨">origin</a>
      <dd data-md>
       <p><var>origin</var></p>
      <dt data-md><a data-link-type="dfn" href="#subdomains" id="ref-for-subdomains">subdomains</a> flag
      <dd data-md>
       <p><code>include</code> if <var>item</var> has a member named <a data-link-type="dfn" href="#include_subdomains" id="ref-for-include_subdomains">include_subdomains</a> whose value is <code>true</code>, <code>exclude</code> otherwise</p>
      <dt data-md><a data-link-type="dfn" href="#reporting-group" id="ref-for-reporting-group">reporting group</a>
      <dd data-md>
       <p>the value of <var>item</var>’s <a data-link-type="dfn" href="#report_to" id="ref-for-report_to③">report_to</a> member</p>
      <dt data-md><a data-link-type="dfn" href="#ttl" id="ref-for-ttl①">ttl</a>
      <dd data-md>
       <p>the value of <var>item</var>’s <a data-link-type="dfn" href="#max_age" id="ref-for-max_age③">max_age</a> member</p>
      <dt data-md><a data-link-type="dfn" href="#creation" id="ref-for-creation②">creation</a>
      <dd data-md>
       <p>the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-wall-clock" id="ref-for-dfn-wall-clock②">wall clock</a>’s <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-unsafe-current-time" id="ref-for-dfn-unsafe-current-time②">unsafe current time</a></p>
      <dt data-md><a data-link-type="dfn" href="#successful-sampling-rate" id="ref-for-successful-sampling-rate①">successful sampling rate</a>
      <dd data-md>
       <p>the value of <var>item</var>’s <a data-link-type="dfn" href="#success_fraction" id="ref-for-success_fraction①">success_fraction</a> member, if present; <code>0.0</code> otherwise</p>
      <dt data-md><a data-link-type="dfn" href="#failure-sampling-rate" id="ref-for-failure-sampling-rate①">failure sampling rate</a>
      <dd data-md>
       <p>the value of <var>item</var>’s <a data-link-type="dfn" href="#failure_fraction" id="ref-for-failure_fraction①">failure_fraction</a> member, if present; <code>1.0</code> otherwise</p>
     </dl>
    <li data-md>
     <p>If there is already an entry in the <a data-link-type="dfn" href="#policy-cache" id="ref-for-policy-cache③">policy cache</a> for (<var>key</var>, <var>origin</var>), replace it with <var>policy</var>; otherwise, insert <var>policy</var> into the <a data-link-type="dfn" href="#policy-cache" id="ref-for-policy-cache④">policy cache</a> for (<var>key</var>, <var>origin</var>).</p>
   </ol>
   <h2 class="heading settled" data-level="5" id="report-delivery"><span class="secno">5. </span><span class="content">Report delivery</span><a class="self-link" href="#report-delivery"></a></h2>
   <h3 class="heading settled" data-level="5.1" id="choose-a-policy-for-a-request"><span class="secno">5.1. </span><span class="content">Choose a policy for a request</span><a class="self-link" href="#choose-a-policy-for-a-request"></a></h3>
   <p>Given a <a data-link-type="dfn" href="#network-request" id="ref-for-network-request①⑥">network request</a> (<var>request</var>), this algorithm determines which <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies③⓪">NEL policy</a> in the <a data-link-type="dfn" href="#policy-cache" id="ref-for-policy-cache⑤">policy cache</a> should be used to generate reports for that <a data-link-type="dfn" href="#network-request" id="ref-for-network-request①⑦">network request</a>.</p>
   <ol>
    <li data-md>
     <p>Let <var>origin</var> be <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-origin" id="ref-for-concept-request-origin①⓪">origin</a>.</p>
    <li data-md>
     <p>Let <var>key</var> be the result of calling <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#determine-the-network-partition-key" id="ref-for-determine-the-network-partition-key①">determine the network partition key</a>, given <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-reserved-client" id="ref-for-concept-request-reserved-client①">reserved client</a>.</p>
    <li data-md>
     <p>If there is an entry in the <a data-link-type="dfn" href="#policy-cache" id="ref-for-policy-cache⑥">policy cache</a> for (<var>key</var>, <var>origin</var>):</p>
     <ol>
      <li data-md>
       <p>Let <var>policy</var> be that entry.</p>
      <li data-md>
       <p>If <var>policy</var> is not <a data-link-type="dfn" href="#expired" id="ref-for-expired">expired</a>, return it.</p>
     </ol>
    <li data-md>
     <p>For each <var>parent origin</var> that is a superdomain match <a data-link-type="biblio" href="#biblio-rfc6797" title="HTTP Strict Transport Security (HSTS)">[RFC6797]</a> of <var>origin</var>:</p>
     <ol>
      <li data-md>
       <p>If there is an entry in the <a data-link-type="dfn" href="#policy-cache" id="ref-for-policy-cache⑦">policy cache</a> for (<var>key</var>, <var>parent origin</var>):</p>
       <ol>
        <li data-md>
         <p>Let <var>policy</var> be that entry.</p>
        <li data-md>
         <p>If <var>policy</var> is not <a data-link-type="dfn" href="#expired" id="ref-for-expired①">expired</a>, and its <a data-link-type="dfn" href="#subdomains" id="ref-for-subdomains①">subdomains</a> flag is <code>include</code>, return it.</p>
       </ol>
     </ol>
    <li data-md>
     <p>Return <code>no policy</code>.</p>
   </ol>
   <h3 class="heading settled" data-level="5.2" id="generate-a-network-error-report"><span class="secno">5.2. </span><span class="content">Generate a network error report</span><a class="self-link" href="#generate-a-network-error-report"></a></h3>
   <p>Given a <a data-link-type="dfn" href="#network-request" id="ref-for-network-request①⑧">network request</a> (<var>request</var>) and its corresponding <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response②">response</a> (<var>response</var>), this algorithm generates a report about <var>request</var> if instructed to by any matching <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies③①">NEL policy</a>, and returns the report and the NEL policy. Otherwise this algorithm returns null.</p>
   <ol>
    <li data-md>
     <p>If the result of executing the "<a data-link-type="dfn" href="https://www.w3.org/TR/secure-contexts/#is-origin-trustworthy" id="ref-for-is-origin-trustworthy①">Is origin potentially trustworthy?</a>" algorithm on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-origin" id="ref-for-concept-request-origin①①">origin</a> is <strong>not</strong> <code>Potentially Trustworthy</code>, return null.</p>
    <li data-md>
     <p>Let <var>origin</var> be <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-origin" id="ref-for-concept-request-origin①②">origin</a>.</p>
    <li data-md>
     <p>Let <var>policy</var> be the result of executing <a href="#choose-a-policy-for-a-request">§ 5.1 Choose a policy for a request</a> on <var>request</var>. If <var>policy</var> is <code>no policy</code>, return null.</p>
    <li data-md>
     <p>Determine the active sampling rate for this request:</p>
     <ul>
      <li data-md>
       <p>If <var>request</var> <a data-link-type="dfn" href="#succeed" id="ref-for-succeed④">succeeded</a>, let <var>sampling rate</var> be <var>policy</var>’s <a data-link-type="dfn" href="#successful-sampling-rate" id="ref-for-successful-sampling-rate②">successful sampling rate</a>.</p>
      <li data-md>
       <p>If <var>request</var> <a data-link-type="dfn" href="#fail" id="ref-for-fail⑤">failed</a>, let <var>sampling rate</var> be <var>policy</var>’s <a data-link-type="dfn" href="#failure-sampling-rate" id="ref-for-failure-sampling-rate②">failure sampling rate</a>.</p>
     </ul>
    <li data-md>
     <p>Decide whether or not to report on this request. Let <var>roll</var> be a random number between 0.0 and 1.0, inclusive. If <var>roll</var> > <var>sampling rate</var>, return null.</p>
    <li data-md>
     <p>Let <var>report body</var> be a new ECMAScript object with the following properties: <a data-link-type="biblio" href="#biblio-ecma-262" title="ECMAScript Language Specification">[ECMA-262]</a></p>
     <dl>
      <dt data-md><code>sampling_fraction</code>
      <dd data-md>
       <p><var>sampling rate</var></p>
      <dt data-md><code>elapsed_time</code>
      <dd data-md>
       <p>The elapsed number of milliseconds between the start of the resource fetch and when it was completed or aborted by the user agent.</p>
      <dt data-md><code>phase</code>
      <dd data-md>
       <p>If <var>request</var> <a data-link-type="dfn" href="#fail" id="ref-for-fail⑥">failed</a>, the <a data-link-type="dfn" href="#type-phase" id="ref-for-type-phase">phase</a> of its <a data-link-type="dfn" href="#network-errors" id="ref-for-network-errors④">network error</a>. If <var>request</var> <a data-link-type="dfn" href="#succeed" id="ref-for-succeed⑤">succeeded</a>, <code>"application"</code>.</p>
      <dt data-md><code>type</code>
      <dd data-md>
       <p>If <var>request</var> <a data-link-type="dfn" href="#fail" id="ref-for-fail⑦">failed</a>, the <a data-link-type="dfn" href="#types" id="ref-for-types①">type</a> of its <a data-link-type="dfn" href="#network-errors" id="ref-for-network-errors⑤">network error</a>. If <var>request</var> <a data-link-type="dfn" href="#succeed" id="ref-for-succeed⑥">succeeded</a>, <code>"ok"</code>.</p>
     </dl>
    <li data-md>
     <p>If <var>report body</var>’s <code>phase</code> property is not <code>dns</code>, append the following properties to <var>report body</var>:</p>
     <dl>
      <dt data-md><code>server_ip</code>
      <dd data-md>
       <p>The IP address of the <a data-link-type="dfn" href="#server" id="ref-for-server⑦">server</a> to which the user agent sent the request, if available. Otherwise, an empty string.</p>
       <ul>
        <li data-md>
         <p>A host identified by an IPv4 address is represented in dotted-decimal notation (a sequence of four decimal numbers in the range 0 to 255, separated by "."). <a data-link-type="biblio" href="#biblio-rfc1123" title="Requirements for Internet Hosts - Application and Support">[RFC1123]</a></p>
        <li data-md>
         <p>A host identified by an IPv6 address is represented as an ordered list of eight 16-bit pieces (a sequence of <code>x:x:x:x:x:x:x:x</code>, where the <a class="property css" data-link-type="property" href="https://svgwg.org/svg2-draft/geometry.html#XProperty" id="ref-for-XProperty">x</a>s are one to four hexadecimal digits of the eight 16-bit pieces of the address). <a data-link-type="biblio" href="#biblio-rfc4291" title="IP Version 6 Addressing Architecture">[RFC4291]</a></p>
       </ul>
      <dt data-md><code>protocol</code>
      <dd data-md>
       <p>The network protocol <a data-link-type="biblio" href="#biblio-resource-timing-2" title="Resource Timing">[RESOURCE-TIMING-2]</a> used to fetch the resource as identified by the ALPN Protocol ID, if available. Otherwise, <code>""</code>.</p>
     </dl>
    <li data-md>
     <p>If <var>report body</var>’s <code>phase</code> property is not <code>dns</code> or <code>connection</code>, append the following properties to <var>report body</var>:</p>
     <dl>
      <dt data-md><code>referrer</code>
      <dd data-md>
       <p><var>request</var>’s referrer, as determined by the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-referrer-policy" id="ref-for-concept-request-referrer-policy">referrer policy</a> associated with its client.</p>
      <dt data-md><code>method</code>
      <dd data-md>
       <p><var>request</var>’s request method <a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a>.</p>
      <dt data-md><code>status_code</code>
      <dd data-md>
       <p>The status code <a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> of the HTTP response, if available. Otherwise, <code>0</code>.</p>
     </dl>
    <li data-md>
     <p>If <var>origin</var> is not equal to <var>policy</var>’s <a data-link-type="dfn" href="#policy-origin" id="ref-for-policy-origin①">policy origin</a>, <var>policy</var>’s <a data-link-type="dfn" href="#subdomains" id="ref-for-subdomains②">subdomains</a> flag is <code>include</code>, and <var>report body</var>’s <code>phase</code> property is not <code>dns</code>, return null.</p>
     <p class="note" role="note"><span class="marker">Note:</span> This step ensures that <a data-link-type="dfn" href="#subdomains" id="ref-for-subdomains③">subdomain</a> <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies③②">NEL policies</a> can only be used to generate reports about subdomains of the <a data-link-type="dfn" href="#policy-origin" id="ref-for-policy-origin②">policy origin</a> during the <a data-link-type="dfn" href="#dns-resolution" id="ref-for-dns-resolution②">DNS resolution</a> <a data-link-type="dfn" href="#phase" id="ref-for-phase⑤">phase</a> of a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑥">request</a>. See <a href="#privacy-considerations">§ 9 Privacy Considerations</a> for more details.</p>
    <li data-md>
     <p>If <var>report body</var>’s <code>phase</code> property is not <code>dns</code>, and <var>report body</var>’s <code>server_ip</code> property is non-empty and not equal to <var>policy</var>’s <a data-link-type="dfn" href="#received-ip-address" id="ref-for-received-ip-address①">received IP address</a>:</p>
     <ol>
      <li data-md>
       <p>Set <var>report body</var>’s <code>phase</code> to <code>dns</code>.</p>
      <li data-md>
       <p>Set <var>report body</var>’s <code>type</code> to <code>dns.address_changed</code>.</p>
      <li data-md>
       <p>Clear <var>report body</var>’s <code>status_code</code>, and <code>elapsed_time</code> properties.</p>
      <li data-md>
       <p class="assertion">Assert: All fields in <var>report body</var> that are derived from information not available during <a data-link-type="dfn" href="#dns-resolution" id="ref-for-dns-resolution③">DNS resolution</a> have been cleared.</p>
     </ol>
     <p class="note" role="note"><span class="marker">Note:</span> This step "downgrades" a NEL report if the IP addresses of the <a data-link-type="dfn" href="#server" id="ref-for-server⑧">server</a> and the <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies③③">policy</a> don’t match. This is a privacy protection, ensuring that NEL reports are only sent to the owner of the service that the report describes. If the IP addresses don’t match, then the user agent can only verify that the <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies③④">NEL policy</a> was sent by the owner of the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-origin" id="ref-for-concept-request-origin①③">origin</a>’s <dfn class="dfn-paneled" data-cite="RFC1034#section-3.1" data-dfn-type="dfn" data-noexport id="domain-name">domain name</dfn>; it cannot verify that the policy was sent by the owner of the <a data-link-type="dfn" href="#server" id="ref-for-server⑨">server</a> this <a data-link-type="dfn" href="#domain-name" id="ref-for-domain-name">domain name</a> resolves to. We therefore downgrade the report to only contain information about <a data-link-type="dfn" href="#dns-resolution" id="ref-for-dns-resolution④">DNS resolution</a>. See <a href="#privacy-considerations">§ 9 Privacy Considerations</a> and <a href="#origins-with-multiple-ip-addresses">§ 7.4 Origins with multiple IP addresses</a> for more details.</p>
    <li data-md>
     <p>If <var>policy</var> is <a data-link-type="dfn" href="#stale" id="ref-for-stale">stale</a>, then delete <var>policy</var> from the <a data-link-type="dfn" href="#policy-cache" id="ref-for-policy-cache⑧">policy cache</a>.</p>
    <li data-md>
     <p>Return <var>report body</var> and <var>policy</var>.</p>
   </ol>
   <h3 class="heading settled" data-level="5.3" id="deliver-a-network-report"><span class="secno">5.3. </span><span class="content">Deliver a network report</span><a class="self-link" href="#deliver-a-network-report"></a></h3>
   <p>Given a ECMAScript object (<var>report body</var>, usually returned from <a href="#generate-a-network-error-report">§ 5.2 Generate a network error report</a> and then augmented by the calling specification) and its matching <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies③⑤">NEL policy</a> (<var>policy</var>) and <a data-link-type="dfn" href="#network-request" id="ref-for-network-request①⑨">network request</a> (<var>request</var>), this algorithm queues the report for delivery.</p>
   <ol>
    <li data-md>
     <p>Let <var>url</var> be <var>request</var>’s URL.</p>
    <li data-md>
     <p>Clear <var>url</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-fragment" id="ref-for-concept-url-fragment">fragment</a>.</p>
    <li data-md>
     <p>If <var>report body</var>’s <code>phase</code> property is <code>dns</code> or <code>connection</code>:</p>
     <ol>
      <li data-md>
       <p>Clear <var>url</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-path" id="ref-for-concept-url-path">path</a> and <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-query" id="ref-for-concept-url-query">query</a>.</p>
     </ol>
    <li data-md>
     <p><a data-link-type="dfn" href="https://w3c.github.io/reporting/#generate-a-network-report" id="ref-for-generate-a-network-report">Generate a network report</a> given these parameters:</p>
     <dl>
      <dt data-md>type
      <dd data-md>
       <p><code>network-error</code></p>
      <dt data-md>data
      <dd data-md>
       <p><var>report body</var></p>
      <dt data-md>endpoint group
      <dd data-md>
       <p><var>policy</var>’s <a data-link-type="dfn" href="#reporting-group" id="ref-for-reporting-group①">reporting group</a></p>
      <dt data-md>url
      <dd data-md>
       <p>The result of running the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer" id="ref-for-concept-url-serializer">URL serializer</a> on <var>url</var>.</p>
     </dl>
   </ol>
   <h2 class="heading settled" data-level="6" id="predefined-network-error-types"><span class="secno">6. </span><span class="content">Predefined network error types</span><a class="self-link" href="#predefined-network-error-types"></a></h2>
   <p>There are several predefined <a data-link-type="dfn" href="#network-errors" id="ref-for-network-errors⑥">network error</a> <a data-link-type="dfn" href="#types" id="ref-for-types②">types</a>.</p>
   <p>The user agent MAY extend this list with custom <a data-link-type="dfn" href="#network-errors" id="ref-for-network-errors⑦">network error</a> <a data-link-type="dfn" href="#types" id="ref-for-types③">types</a> — e.g. to accommodate new protocols, or more detailed error descriptions of existing ones. When doing so, the user agent SHOULD follow the dot-delimited pattern (<code>[group].[optional-subgroup].[error-name]</code>) for the <a data-link-type="dfn" href="#types" id="ref-for-types④">type</a> names to facilitate simple and consistent processing of the error reports — e.g. the collector may provide aggregation by category and/or one or multiple subgroups.</p>
   <h3 class="heading settled" data-level="6.1" id="dns-resolution-errors"><span class="secno">6.1. </span><span class="content">DNS resolution errors</span><a class="self-link" href="#dns-resolution-errors"></a></h3>
   <p>All of the <a data-link-type="dfn" href="#network-errors" id="ref-for-network-errors⑧">network errors</a> in this section occur during <a data-link-type="dfn" href="#dns-resolution" id="ref-for-dns-resolution⑤">DNS resolution</a>, and therefore have a <a data-link-type="dfn" href="#type-phase" id="ref-for-type-phase①">phase</a> of <code>dns</code>.</p>
   <dl>
    <dt data-md><code>dns.unreachable</code>
    <dd data-md>
     <p>DNS server is unreachable</p>
    <dt data-md><code>dns.name_not_resolved</code>
    <dd data-md>
     <p>DNS server responded but is unable to resolve the address</p>
    <dt data-md><code>dns.failed</code>
    <dd data-md>
     <p>Request to the DNS server failed due to reasons not covered by previous errors</p>
    <dt data-md><code>dns.address_changed</code>
    <dd data-md>
     <p>Indicates that the resolved IP address for a request’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-origin" id="ref-for-concept-request-origin①④">origin</a> has changed since the corresponding <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies③⑥">NEL policy</a> was received</p>
   </dl>
   <h3 class="heading settled" data-level="6.2" id="secure-connection-establishment-errors"><span class="secno">6.2. </span><span class="content">Secure connection establishment errors</span><a class="self-link" href="#secure-connection-establishment-errors"></a></h3>
   <p>All of the <a data-link-type="dfn" href="#network-errors" id="ref-for-network-errors⑨">network errors</a> in this section occur during <a data-link-type="dfn" href="#secure-connection-establishment" id="ref-for-secure-connection-establishment①">secure connection establishment</a>, and therefore have a <a data-link-type="dfn" href="#type-phase" id="ref-for-type-phase②">phase</a> of <code>connection</code>.</p>
   <dl>
    <dt data-md><code>tcp.timed_out</code>
    <dd data-md>
     <p>TCP connection to the server timed out</p>
    <dt data-md><code>tcp.closed</code>
    <dd data-md>
     <p>The TCP connection was closed by the server</p>
    <dt data-md><code>tcp.reset</code>
    <dd data-md>
     <p>The TCP connection was reset</p>
    <dt data-md><code>tcp.refused</code>
    <dd data-md>
     <p>The TCP connection was refused by the server</p>
    <dt data-md><code>tcp.aborted</code>
    <dd data-md>
     <p>The TCP connection was aborted</p>
    <dt data-md><code>tcp.address_invalid</code>
    <dd data-md>
     <p>The IP address is invalid</p>
    <dt data-md><code>tcp.address_unreachable</code>
    <dd data-md>
     <p>The IP address is unreachable</p>
    <dt data-md><code>tcp.failed</code>
    <dd data-md>
     <p>The TCP connection failed due to reasons not covered by previous errors</p>
    <dt data-md><code>tls.version_or_cipher_mismatch</code>
    <dd data-md>
     <p>The TLS connection was aborted due to version or cipher mismatch</p>
    <dt data-md><code>tls.bad_client_auth_cert</code>
    <dd data-md>
     <p>The TLS connection was aborted due to invalid client certificate</p>
    <dt data-md><code>tls.cert.name_invalid</code>
    <dd data-md>
     <p>The TLS connection was aborted due to invalid name</p>
    <dt data-md><code>tls.cert.date_invalid</code>
    <dd data-md>
     <p>The TLS connection was aborted due to invalid certificate date</p>
    <dt data-md><code>tls.cert.authority_invalid</code>
    <dd data-md>
     <p>The TLS connection was aborted due to invalid issuing authority</p>
    <dt data-md><code>tls.cert.invalid</code>
    <dd data-md>
     <p>The TLS connection was aborted due to invalid certificate</p>
    <dt data-md><code>tls.cert.revoked</code>
    <dd data-md>
     <p>The TLS connection was aborted due to revoked server certificate</p>
    <dt data-md><code>tls.cert.pinned_key_not_in_cert_chain</code>
    <dd data-md>
     <p>The TLS connection was aborted due to a key pinning error</p>
    <dt data-md><code>tls.protocol.error</code>
    <dd data-md>
     <p>The TLS connection was aborted due to a TLS protocol error</p>
    <dt data-md><code>tls.failed</code>
    <dd data-md>
     <p>The TLS connection failed due to reasons not covered by previous errors</p>
   </dl>
   <h3 class="heading settled" data-level="6.3" id="transmission-errors"><span class="secno">6.3. </span><span class="content">Transmission of request and response errors</span><a class="self-link" href="#transmission-errors"></a></h3>
   <p>All of the <a data-link-type="dfn" href="#network-errors" id="ref-for-network-errors①⓪">network errors</a> in this section occur during the <a data-link-type="dfn" href="#transmission-of-request-and-response" id="ref-for-transmission-of-request-and-response②">transmission of request and response</a>, and therefore have a <a data-link-type="dfn" href="#type-phase" id="ref-for-type-phase③">phase</a> of <code>application</code>.</p>
   <dl>
    <dt data-md><code>http.error</code>
    <dd data-md>
     <p>The user agent successfully received a response, but it had a <a data-link-type="dfn" href="#4xx" id="ref-for-4xx①">4xx</a> or <a data-link-type="dfn" href="#5xx" id="ref-for-5xx①">5xx</a> status code</p>
    <dt data-md><code>http.protocol.error</code>
    <dd data-md>
     <p>The connection was aborted due to an HTTP protocol error</p>
    <dt data-md><code>http.response.invalid</code>
    <dd data-md>
     <p>Response is empty, has a content-length mismatch, has improper encoding, and/or other conditions that prevent user agent from processing the response</p>
    <dt data-md><code>http.response.redirect_loop</code>
    <dd data-md>
     <p>The request was aborted due to a detected redirect loop</p>
    <dt data-md><code>http.failed</code>
    <dd data-md>
     <p>The connection failed due to errors in HTTP protocol not covered by previous errors</p>
    <dt data-md><code>abandoned</code>
    <dd data-md>
     <p>User aborted the resource fetch before it is complete</p>
    <dt data-md><code>unknown</code>
    <dd data-md>
     <p>error type is unknown</p>
   </dl>
   <h2 class="heading settled" data-level="7" id="examples"><span class="secno">7. </span><span class="content">Examples</span><a class="self-link" href="#examples"></a></h2>
   <h3 class="heading settled" data-level="7.1" id="sample-policy-definitions"><span class="secno">7.1. </span><span class="content">Sample Policy Definitions</span><a class="self-link" href="#sample-policy-definitions"></a></h3>
   <div class="example" id="example-dc859dcd">
    <a class="self-link" href="#example-dc859dcd"></a> 
<pre>GET / HTTP/1.1
Host: example.com

&lt; HTTP/1.1 200 OK
&lt; ...
&lt; Report-To: {"group": "network-errors", "max_age": 2592000,
              "endpoints": [{"url": "https://example.com/upload-reports"}]}
&lt; NEL: {"report_to": "network-errors", "max_age": 2592000}
</pre>
   </div>
   <p>This <code>NEL</code> header defines a <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies③⑦">NEL policy</a>, instructing the user agent to report network errors about <code>example.com</code> to the <a data-link-type="dfn" href="https://w3c.github.io/reporting/#endpoint-group" id="ref-for-endpoint-group⑤">endpoint group</a> named <code>network-errors</code>. The policy applies for 2592000 seconds (30 days).</p>
   <p>Note that above registration will only succeed if the response is communicated from a <a data-link-type="dfn" href="https://www.w3.org/TR/secure-contexts/#potentially-trustworthy-origin" id="ref-for-potentially-trustworthy-origin">potentially trustworthy origin</a>.</p>
   <div class="example" id="example-7d73f6c1">
    <a class="self-link" href="#example-7d73f6c1"></a> 
<pre>GET / HTTP/1.1
Host: example.com

&lt; HTTP/1.1 200 OK
&lt; ...
&lt; NEL: {"max_age": 0}
</pre>
   </div>
   <p>This <code>NEL</code> header instructs the user agent to remove any existing <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies③⑧">NEL policy</a> for <code>example.com</code>.</p>
   <h3 class="heading settled" data-level="7.2" id="sample-network-error-reports"><span class="secno">7.2. </span><span class="content">Sample Network Error Reports</span><a class="self-link" href="#sample-network-error-reports"></a></h3>
   <p>This section contains example <a data-link-type="dfn" href="#network-errors" id="ref-for-network-errors①①">network error</a> <a data-link-type="dfn" href="https://w3c.github.io/reporting/#concept-report" id="ref-for-concept-report①">reports</a> the user agent might queue when a network error is encountered for an <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-origin" id="ref-for-concept-request-origin①⑤">origin</a> with a registered <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies③⑨">NEL policy</a>. We show the full report payload that would be created by the <a data-link-type="biblio" href="#biblio-reporting" title="Reporting API">[REPORTING]</a> API when uploading the report; the payload’s <code>body</code> field contains the <a data-link-type="dfn" href="#network-errors" id="ref-for-network-errors①②">network error</a> <a data-link-type="dfn" href="https://w3c.github.io/reporting/#report-body" id="ref-for-report-body">report body</a>.</p>
   <div class="example" id="example-f208c464">
    <a class="self-link" href="#example-f208c464"></a> 
<pre class="highlight"><c- p>{</c->
  <c- f>"age"</c-><c- p>:</c-> <c- mi>0</c-><c- p>,</c->
  <c- f>"type"</c-><c- p>:</c-> <c- u>"network-error"</c-><c- p>,</c->
  <c- f>"url"</c-><c- p>:</c-> <c- u>"https://www.example.com/"</c-><c- p>,</c->
  <c- f>"body"</c-><c- p>:</c-> <c- p>{</c->
    <c- f>"sampling_fraction"</c-><c- p>:</c-> <c- mf>0.5</c-><c- p>,</c->
    <c- f>"referrer"</c-><c- p>:</c-> <c- u>"http://example.com/"</c-><c- p>,</c->
    <c- f>"server_ip"</c-><c- p>:</c-> <c- u>"2001:DB8:0:0:0:0:0:42"</c-><c- p>,</c->
    <c- f>"protocol"</c-><c- p>:</c-> <c- u>"h2"</c-><c- p>,</c->
    <c- f>"method"</c-><c- p>:</c-> <c- u>"GET"</c-><c- p>,</c->
    <c- f>"status_code"</c-><c- p>:</c-> <c- mi>200</c-><c- p>,</c->
    <c- f>"elapsed_time"</c-><c- p>:</c-> <c- mi>823</c-><c- p>,</c->
    <c- f>"phase"</c-><c- p>:</c-> <c- u>"application"</c-><c- p>,</c->
    <c- f>"type"</c-><c- p>:</c-> <c- u>"http.protocol.error"</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
   </div>
   <p>This report indicates that the user agent attempted to navigate from <code>example.com</code> to <code>www.example.com</code>, which successfully resolved to <code>2001:DB8::42</code>. However, while the user agent received a 200 response from the server via the HTTP/2 (<code>h2</code>) protocol, it encountered a protocol error in the exchange and was forced to abandon the navigation. The user agent aborted the navigation 823 milliseconds after it started. Finally, the user agent sent this report immediately after the network error was encountered – i.e. the report age is 0.</p>
   <div class="example" id="example-081cfa7d">
    <a class="self-link" href="#example-081cfa7d"></a> 
<pre class="highlight"><c- p>{</c->
  <c- f>"age"</c-><c- p>:</c-> <c- mi>0</c-><c- p>,</c->
  <c- f>"type"</c-><c- p>:</c-> <c- u>"network-error"</c-><c- p>,</c->
  <c- f>"url"</c-><c- p>:</c-> <c- u>"https://widget.com/thing.js"</c-><c- p>,</c->
  <c- f>"body"</c-><c- p>:</c-> <c- p>{</c->
    <c- f>"sampling_fraction"</c-><c- p>:</c-> <c- mf>1.0</c-><c- p>,</c->
    <c- f>"referrer"</c-><c- p>:</c-> <c- u>"https://www.example.com/"</c-><c- p>,</c->
    <c- f>"server_ip"</c-><c- p>:</c-> <c- u>""</c-><c- p>,</c->
    <c- f>"protocol"</c-><c- p>:</c-> <c- u>""</c-><c- p>,</c->
    <c- f>"method"</c-><c- p>:</c-> <c- u>"GET"</c-><c- p>,</c->
    <c- f>"status_code"</c-><c- p>:</c-> <c- mi>0</c-><c- p>,</c->
    <c- f>"elapsed_time"</c-><c- p>:</c-> <c- mi>143</c-><c- p>,</c->
    <c- f>"phase"</c-><c- p>:</c-> <c- u>"dns"</c-><c- p>,</c->
    <c- f>"type"</c-><c- p>:</c-> <c- u>"dns.name_not_resolved"</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
   </div>
   <p>The above report indicates that the user agent attempted to fetch <code>https://widget.com/thing.js</code> from <code>https://www.example.com/</code>. However, the user agent was unable to resolve the DNS name (<code>widget.com</code>) and the request was aborted by the user agent after 143 milliseconds. Because a previous request to <code>widget.com</code> delivered a valid <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies④⓪">NEL policy</a>, the user agent generates a <a data-link-type="dfn" href="#network-errors" id="ref-for-network-errors①③">network error</a> <a data-link-type="dfn" href="https://w3c.github.io/reporting/#concept-report" id="ref-for-concept-report②">report</a> for this request. The report was uploaded immediately after the <a data-link-type="dfn" href="#network-errors" id="ref-for-network-errors①④">network error</a> was encountered – i.e. the report age is 0.</p>
   <h3 class="heading settled" data-level="7.3" id="dns-misconfiguration"><span class="secno">7.3. </span><span class="content">DNS misconfiguration</span><a class="self-link" href="#dns-misconfiguration"></a></h3>
   <div class="example" id="example-c26fda0d">
    <a class="self-link" href="#example-c26fda0d"></a> 
<pre>GET / HTTP/1.1
Host: example.com

&lt; HTTP/1.1 200 OK
&lt; ...
&lt; Report-To: {"group": "network-errors", "max_age": 2592000,
              "endpoints": [{"url": "https://example.com/upload-reports"}]}
&lt; NEL: {"report_to": "network-errors", "max_age": 2592000, "include_subdomains": true}
</pre>
   </div>
   <p>This <code>NEL</code> header allows the owner of <code>example.com</code> to detect when they have misconfigured their DNS servers — for instance, when they have forgotten to add a new resource record resolving <code>new-subdomain.example.com</code> to an IP address. If a user agent tries to make a request to <code>new-subdomain.example.com</code>, it might generate the following report:</p>
   <div class="example" id="example-631359f0">
    <a class="self-link" href="#example-631359f0"></a> 
<pre class="highlight"><c- p>{</c->
  <c- f>"age"</c-><c- p>:</c-> <c- mi>0</c-><c- p>,</c->
  <c- f>"type"</c-><c- p>:</c-> <c- u>"network-error"</c-><c- p>,</c->
  <c- f>"url"</c-><c- p>:</c-> <c- u>"https://new-subdomain.example.com/"</c-><c- p>,</c->
  <c- f>"body"</c-><c- p>:</c-> <c- p>{</c->
    <c- f>"sampling_fraction"</c-><c- p>:</c-> <c- mf>1.0</c-><c- p>,</c->
    <c- f>"server_ip"</c-><c- p>:</c-> <c- u>""</c-><c- p>,</c->
    <c- f>"protocol"</c-><c- p>:</c-> <c- u>"http/1.1"</c-><c- p>,</c->
    <c- f>"method"</c-><c- p>:</c-> <c- u>"GET"</c-><c- p>,</c->
    <c- f>"status_code"</c-><c- p>:</c-> <c- mi>0</c-><c- p>,</c->
    <c- f>"elapsed_time"</c-><c- p>:</c-> <c- mi>48</c-><c- p>,</c->
    <c- f>"phase"</c-><c- p>:</c-> <c- u>"dns"</c-><c- p>,</c->
    <c- f>"type"</c-><c- p>:</c-> <c- u>"dns.name_not_resolved"</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
   </div>
   <h3 class="heading settled" data-level="7.4" id="origins-with-multiple-ip-addresses"><span class="secno">7.4. </span><span class="content">Origins with multiple IP addresses</span><a class="self-link" href="#origins-with-multiple-ip-addresses"></a></h3>
   <p>For <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-origin" id="ref-for-concept-request-origin①⑥">origins</a> whose <a data-link-type="dfn" href="#domain-name" id="ref-for-domain-name①">domain name</a> resolves to multiple IP addresses, NEL will sometimes "downgrade" an error report, providing less information about the cause of the error, since it cannot verify that the owner of the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-origin" id="ref-for-concept-request-origin①⑦">origin</a> is the same as the owner of the <a data-link-type="dfn" href="#server" id="ref-for-server①⓪">server</a> handling the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑦">request</a>.</p>
   <p>As an example, assume that <code>example.com</code> is handled by three <a data-link-type="dfn" href="#server" id="ref-for-server①①">servers</a>, each with a different IP address. The owner of the service configures DNS to resolve <code>example.com</code> to <code>192.0.2.1</code>, <code>192.0.2.2</code>, and <code>192.0.2.3</code>, and relies on user agents to balance their requests across these three IP addresses. The service owner delivers the following <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies④①">NEL policy</a>:</p>
   <div class="example" id="example-3c8c4fa2">
    <a class="self-link" href="#example-3c8c4fa2"></a> 
<pre>GET / HTTP/1.1
Host: example.com

&lt; HTTP/1.1 200 OK
&lt; ...
&lt; Report-To: {"group": "network-errors", "max_age": 2592000,
              "endpoints": [{"url": "https://example.com/upload-reports"}]}
&lt; NEL: {"report_to": "network-errors", "max_age": 2592000,
        "success_fraction": 1.0, "failure_fraction": 1.0}
</pre>
   </div>
   <p>Given the above, consider the following sequence of events:</p>
   <ol>
    <li data-md>
     <p>The user agent sends a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑧">request</a> to <code>192.0.2.1</code>, and receives a successful <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response③">response</a> from the <a data-link-type="dfn" href="#server" id="ref-for-server①②">server</a>. This response includes the above <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies④②">NEL policy</a>, and the user agent sets the policy’s <a data-link-type="dfn" href="#received-ip-address" id="ref-for-received-ip-address②">received IP address</a> to <code>192.0.2.1</code>. Since the <a data-link-type="dfn" href="#received-ip-address" id="ref-for-received-ip-address③">received IP address</a> matches the <a data-link-type="dfn" href="#server" id="ref-for-server①③">server</a>’s IP address (which it must for any successful request), it generates the following NEL report:</p>
     <div class="example" id="example-c1b4633e">
      <a class="self-link" href="#example-c1b4633e"></a> 
<pre class="highlight"><c- p>{</c->
  <c- f>"age"</c-><c- p>:</c-> <c- mi>0</c-><c- p>,</c->
  <c- f>"type"</c-><c- p>:</c-> <c- u>"network-error"</c-><c- p>,</c->
  <c- f>"url"</c-><c- p>:</c-> <c- u>"https://example.com/"</c-><c- p>,</c->
  <c- f>"body"</c-><c- p>:</c-> <c- p>{</c->
    <c- f>"sampling_fraction"</c-><c- p>:</c-> <c- mf>1.0</c-><c- p>,</c->
    <c- f>"server_ip"</c-><c- p>:</c-> <c- u>"192.0.2.1"</c-><c- p>,</c->
    <c- f>"protocol"</c-><c- p>:</c-> <c- u>"http/1.1"</c-><c- p>,</c->
    <c- f>"method"</c-><c- p>:</c-> <c- u>"GET"</c-><c- p>,</c->
    <c- f>"status_code"</c-><c- p>:</c-> <c- mi>200</c-><c- p>,</c->
    <c- f>"elapsed_time"</c-><c- p>:</c-> <c- mi>57</c-><c- p>,</c->
    <c- f>"phase"</c-><c- p>:</c-> <c- u>"application"</c-><c- p>,</c->
    <c- f>"type"</c-><c- p>:</c-> <c- u>"ok"</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
     </div>
    <li data-md>
     <p>The user agent sends a new <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑨">request</a> to <code>192.0.2.2</code>, and receives another successful <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response④">response</a>. This response also includes the <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies④③">NEL policy</a>, and the user agent updates the policy’s <a data-link-type="dfn" href="#received-ip-address" id="ref-for-received-ip-address④">received IP address</a> to <code>192.0.2.2</code>. Since the <a data-link-type="dfn" href="#received-ip-address" id="ref-for-received-ip-address⑤">received IP address</a> matches the <a data-link-type="dfn" href="#server" id="ref-for-server①④">server</a>’s IP address (which it must for any successful request), it generates the following NEL report:</p>
     <div class="example" id="example-e62dfc8c">
      <a class="self-link" href="#example-e62dfc8c"></a> 
<pre class="highlight"><c- p>{</c->
  <c- f>"age"</c-><c- p>:</c-> <c- mi>0</c-><c- p>,</c->
  <c- f>"type"</c-><c- p>:</c-> <c- u>"network-error"</c-><c- p>,</c->
  <c- f>"url"</c-><c- p>:</c-> <c- u>"https://example.com/"</c-><c- p>,</c->
  <c- f>"body"</c-><c- p>:</c-> <c- p>{</c->
    <c- f>"sampling_fraction"</c-><c- p>:</c-> <c- mf>1.0</c-><c- p>,</c->
    <c- f>"server_ip"</c-><c- p>:</c-> <c- u>"192.0.2.2"</c-><c- p>,</c->
    <c- f>"protocol"</c-><c- p>:</c-> <c- u>"http/1.1"</c-><c- p>,</c->
    <c- f>"method"</c-><c- p>:</c-> <c- u>"GET"</c-><c- p>,</c->
    <c- f>"status_code"</c-><c- p>:</c-> <c- mi>200</c-><c- p>,</c->
    <c- f>"elapsed_time"</c-><c- p>:</c-> <c- mi>34</c-><c- p>,</c->
    <c- f>"phase"</c-><c- p>:</c-> <c- u>"application"</c-><c- p>,</c->
    <c- f>"type"</c-><c- p>:</c-> <c- u>"ok"</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
     </div>
    <li data-md>
     <p>The user agent then tries to send a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①⓪">request</a> to <code>192.0.2.3</code>, but isn’t able to establish a connection to the server. The user agent still has the <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies④④">NEL policy</a> in the <a data-link-type="dfn" href="#policy-cache" id="ref-for-policy-cache⑨">policy cache</a>, and would ideally use this policy to generate a <code>tcp.timed_out</code> report about the <a data-link-type="dfn" href="#fail" id="ref-for-fail⑧">failed</a> <a data-link-type="dfn" href="#network-request" id="ref-for-network-request②⓪">network request</a>. However, the because policy’s <a data-link-type="dfn" href="#received-ip-address" id="ref-for-received-ip-address⑥">received IP address</a> (<code>192.0.2.2</code>) doesn’t match the IP address that this <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①①">request</a> was sent to, the user agent cannot verify that the server at <code>192.0.2.3</code> is actually owned by the owners of <code>example.com</code>. The user agent must therefore downgrade the report to <code>dns.address_changed</code>:</p>
     <div class="example" id="example-f3f829f6">
      <a class="self-link" href="#example-f3f829f6"></a> 
<pre class="highlight"><c- p>{</c->
  <c- f>"age"</c-><c- p>:</c-> <c- mi>0</c-><c- p>,</c->
  <c- f>"type"</c-><c- p>:</c-> <c- u>"network-error"</c-><c- p>,</c->
  <c- f>"url"</c-><c- p>:</c-> <c- u>"https://example.com/"</c-><c- p>,</c->
  <c- f>"body"</c-><c- p>:</c-> <c- p>{</c->
    <c- f>"sampling_fraction"</c-><c- p>:</c-> <c- mf>1.0</c-><c- p>,</c->
    <c- f>"server_ip"</c-><c- p>:</c-> <c- u>"192.0.2.3"</c-><c- p>,</c->
    <c- f>"protocol"</c-><c- p>:</c-> <c- u>"http/1.1"</c-><c- p>,</c->
    <c- f>"method"</c-><c- p>:</c-> <c- u>"GET"</c-><c- p>,</c->
    <c- f>"status_code"</c-><c- p>:</c-> <c- mi>0</c-><c- p>,</c->
    <c- f>"elapsed_time"</c-><c- p>:</c-> <c- mi>0</c-><c- p>,</c->
    <c- f>"phase"</c-><c- p>:</c-> <c- u>"dns"</c-><c- p>,</c->
    <c- f>"type"</c-><c- p>:</c-> <c- u>"dns.address_changed"</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
     </div>
    <li data-md>
     <p>The user agent then tries to send another <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①②">request</a> to <code>192.0.2.1</code>, but once again isn’t able to establish a connection to the server. Even though the user agent received the <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies④⑤">NEL policy</a> from <code>192.0.2.1</code> at some point in the past, the policy’s <a data-link-type="dfn" href="#received-ip-address" id="ref-for-received-ip-address⑦">received IP address</a> only records where it was <em>most recently</em> received from — in this case, <code>192.0.2.2</code>. The user agent must therefore downgrade the report to <code>dns.address_changed</code>:</p>
     <div class="example" id="example-cbb27c28">
      <a class="self-link" href="#example-cbb27c28"></a> 
<pre class="highlight"><c- p>{</c->
  <c- f>"age"</c-><c- p>:</c-> <c- mi>0</c-><c- p>,</c->
  <c- f>"type"</c-><c- p>:</c-> <c- u>"network-error"</c-><c- p>,</c->
  <c- f>"url"</c-><c- p>:</c-> <c- u>"https://example.com/"</c-><c- p>,</c->
  <c- f>"body"</c-><c- p>:</c-> <c- p>{</c->
    <c- f>"sampling_fraction"</c-><c- p>:</c-> <c- mf>1.0</c-><c- p>,</c->
    <c- f>"server_ip"</c-><c- p>:</c-> <c- u>"192.0.2.1"</c-><c- p>,</c->
    <c- f>"protocol"</c-><c- p>:</c-> <c- u>"http/1.1"</c-><c- p>,</c->
    <c- f>"method"</c-><c- p>:</c-> <c- u>"GET"</c-><c- p>,</c->
    <c- f>"status_code"</c-><c- p>:</c-> <c- mi>0</c-><c- p>,</c->
    <c- f>"elapsed_time"</c-><c- p>:</c-> <c- mi>0</c-><c- p>,</c->
    <c- f>"phase"</c-><c- p>:</c-> <c- u>"dns"</c-><c- p>,</c->
    <c- f>"type"</c-><c- p>:</c-> <c- u>"dns.address_changed"</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
     </div>
   </ol>
   <h2 class="heading settled" data-level="8" id="use-cases"><span class="secno">8. </span><span class="content">Use cases</span><a class="self-link" href="#use-cases"></a></h2>
   <h3 class="heading settled" data-level="8.1" id="reporting-navigation-failures"><span class="secno">8.1. </span><span class="content">Reporting of Navigation Failures</span><a class="self-link" href="#reporting-navigation-failures"></a></h3>
   <p>A navigation request initiated by the user (e.g. via a click on a link, direct input via the location bar, script-initiated due to user interaction, etc.) may fail due any number of connectivity reasons: DNS failure, TCP error, TLS protocol violation, and so on. These errors may be caused by network misconfiguration, transient routing issues, server downtime, malware or other attacks against the user, etc.</p>
   <p>In such cases the destination host is often left unaware of the failed navigation since, by definition, it cannot see the request reach its infrastructure and it is unable to investigate the problem. To address this, the host can register an <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies④⑥">NEL policy</a> with the user agent, which specifies where reports of such failures should be delivered such that they can be investigated.</p>
   <h3 class="heading settled" data-level="8.2" id="reporting-first-party-subresource-failures"><span class="secno">8.2. </span><span class="content">Reporting of First-party Subresource Fetch Failures</span><a class="self-link" href="#reporting-first-party-subresource-failures"></a></h3>
   <p>A typical application requires dozens of resources, the fetching of which is typically initiated via HTML, CSS, or JavaScript. The application requesting such resources can observe failures of most such fetches (e.g. via <code>onerror</code> callbacks), but it does not have access to the detailed network error report of why the failure has occurred - e.g. DNS failure, TCP error, TLS protocol violation, etc.</p>
   <p>To address this, the application can register relevant <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies④⑦">NEL policies</a> with the user agent for the first-party hosts from which the subresources are being fetched. Then, if such a policy is present and a network error is encountered for a resource from an <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-origin" id="ref-for-concept-request-origin①⑧">origin</a> with a registered <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies④⑧">NEL policy</a>, the user agent will report the detailed network error report and enable the application developers to investigate the error.</p>
   <h3 class="heading settled" data-level="8.3" id="reporting-third-party-subresource-failures"><span class="secno">8.3. </span><span class="content">Reporting of Third-party Subresource Fetch Failures</span><a class="self-link" href="#reporting-third-party-subresource-failures"></a></h3>
   <p>In the case where a resource is embedded by a third party, the provider of the resource is often unable to instrument and observe the failure. For example, if <code>example.com</code> embeds a <code>widget.com/thing.js</code> resource on its site, and the user visiting <code>example.com</code> fails to fetch such resource due to a network error, the <code>widget.com</code> host is both unaware of the failure and unable to detect it.</p>
   <p>To address this, <code>widget.com</code> can register an NEL policy for its host. Then, if such policy is present and a network error is encountered while fetching a resource — regardless of whether it is being requested from a first-party or third-party origin — from the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-origin" id="ref-for-concept-request-origin①⑨">origin</a> with a registered <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies④⑨">NEL policy</a>, the user agent will report the network error and enable the provider to investigate the error.</p>
   <h2 class="heading settled" data-level="9" id="privacy-considerations"><span class="secno">9. </span><span class="content">Privacy Considerations</span><a class="self-link" href="#privacy-considerations"></a></h2>
   <p>NEL provides network error reports that could expose new information about the user’s network configuration. For example, an attacker could abuse NEL reporting to probe the user’s network configuration, or to scan for servers on the user’s internal network. Also, similar to HSTS, HPKP, and pinned CSP policies, the stored <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies⑤⓪">NEL policy</a> could be used as a "supercookie" by setting a distinct policy with a custom (per-user) reporting URI to act as an identifier in combination with (or instead of) HTTP cookies.</p>
   <p>To mitigate some of the above risks, NEL registration is restricted to <a data-link-type="dfn" href="https://www.w3.org/TR/secure-contexts/#potentially-trustworthy-origin" id="ref-for-potentially-trustworthy-origin①">potentially trustworthy origins</a>, and delivery of network error reports is similarly restricted to <a data-link-type="dfn" href="https://www.w3.org/TR/secure-contexts/#potentially-trustworthy-origin" id="ref-for-potentially-trustworthy-origin②">potentially trustworthy origins</a>. This disallows a transient HTTP MITM from trivially abusing NEL as a persistent tracker.</p>
   <p>Additionally, the NEL <a data-link-type="dfn" href="#policy-cache" id="ref-for-policy-cache①⓪">policy cache</a> is partitioned using the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#network-partition-key" id="ref-for-network-partition-key③">network partition key</a>, so that a <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies⑤①">NEL policy</a> stored for a site in one embedding context will not be used in a different context (for instance, when embedded by a different top-level site.)</p>
   <p>NEL is intended to augment existing server-side monitoring. NEL reports should only be sent to the owner of the service being requested. For errors that occur during <a data-link-type="dfn" href="#dns-resolution" id="ref-for-dns-resolution⑥">DNS resolution</a>, NEL reports are only generated when the <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies⑤②">NEL policy</a> was received from the owner of the <dfn class="dfn-paneled" data-cite="RFC1034#section-3.1" data-dfn-type="dfn" data-noexport id="domain-namespace-tree">domain namespace tree</dfn> that contains the <a data-link-type="dfn" href="#policy-origin" id="ref-for-policy-origin③">policy origin</a>. For errors that occur during <a data-link-type="dfn" href="#secure-connection-establishment" id="ref-for-secure-connection-establishment②">secure connection establishment</a> or <a data-link-type="dfn" href="#transmission-of-request-and-response" id="ref-for-transmission-of-request-and-response③">transmission of request and response</a>, NEL reports are only generated when the <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies⑤③">NEL policy</a> was received from the owner of the <a data-link-type="dfn" href="#server" id="ref-for-server①⑤">server</a> that the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①③">request</a> was sent to.</p>
   <p>This rationale explains the treatment of the <a data-link-type="dfn" href="#received-ip-address" id="ref-for-received-ip-address⑧">received IP address</a> and <a data-link-type="dfn" href="#subdomains" id="ref-for-subdomains④">subdomains</a> flag of a <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies⑤④">NEL policy</a>. By checking that the policy’s <a data-link-type="dfn" href="#received-ip-address" id="ref-for-received-ip-address⑨">received IP address</a> matches the IP address of the <a data-link-type="dfn" href="#server" id="ref-for-server①⑥">server</a>, NEL extends the trust boundary of the policy to include not just the policy’s <a data-link-type="dfn" href="#policy-origin" id="ref-for-policy-origin④">policy origin</a>, but also the specific server that the user agent is communicating with. This helps prevent (for instance) DNS rebinding attacks, where an attacker delivers a long-lived <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies⑤⑤">NEL policy</a> from a server that they own, and then changes their name servers to resolve the <a data-link-type="dfn" href="#policy-origin" id="ref-for-policy-origin⑤">policy origin</a> to a server they don’t control. Without the <a data-link-type="dfn" href="#received-ip-address" id="ref-for-received-ip-address①⓪">received IP address</a> verification, this would cause user agents to send reports about the second server to the attacker.</p>
   <p>Similarly, <a data-link-type="dfn" href="#subdomains" id="ref-for-subdomains⑤">subdomain</a> <a data-link-type="dfn" href="#nel-policies" id="ref-for-nel-policies⑤⑥">NEL policies</a> are limited, and can only be used to generate reports about subdomains of the <a data-link-type="dfn" href="#policy-origin" id="ref-for-policy-origin⑥">policy origin</a> during the <a data-link-type="dfn" href="#dns-resolution" id="ref-for-dns-resolution⑦">DNS resolution</a> <a data-link-type="dfn" href="#phase" id="ref-for-phase⑥">phase</a> of a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①④">request</a>. During this <a data-link-type="dfn" href="#phase" id="ref-for-phase⑦">phase</a>, there is no <a data-link-type="dfn" href="#server" id="ref-for-server①⑦">server</a> to verify ownership of, and the fact that the policy was received from a superdomain of the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①⑤">request</a>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-origin" id="ref-for-concept-request-origin②⓪">origin</a> is enough to establish ownership of the error. This allows the owners of a particular portion of the <a data-link-type="dfn" href="#domain-namespace-tree" id="ref-for-domain-namespace-tree">domain namespace tree</a> to use NEL to detect <a href="#dns-misconfiguration">§ 7.3 DNS misconfiguration</a> errors, while preventing them from using malicious DNS entries to collect information about servers they don’t control.</p>
   <p>To prevent information leakage, NEL reports about a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①⑥">request</a> do not contain any information that is not visible to the <a data-link-type="dfn" href="#server" id="ref-for-server①⑧">server</a> when processing the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①⑦">request</a>. For errors during <a data-link-type="dfn" href="#dns-resolution" id="ref-for-dns-resolution⑧">DNS resolution</a>, a NEL report only contains information available from DNS itself. This prevents <a data-link-type="dfn" href="#server" id="ref-for-server①⑨">servers</a> from abusing NEL to collect more information about their users than they already have access to. Note that NEL reports will include a web site’s public IP address in the <a data-link-type="dfn" href="https://w3c.github.io/reporting/#report-body" id="ref-for-report-body①">report body</a>’s <code>server_ip</code> field, which may not always be known to the service which generates the NEL header, for example if it is behind a load balancer or other transparent MitM proxy.</p>
   <p class="note" role="note"><span class="marker">Note:</span> As an example, NEL reports specifically do not contain any information about which DNS resolver <a data-link-type="biblio" href="#biblio-rfc1034" title="Domain names - concepts and facilities">[RFC1034]</a> was used to resolve a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①⑧">request</a>’s <a data-link-type="dfn" href="#domain-name" id="ref-for-domain-name②">domain name</a> into an IP address.</p>
   <p>In addition to above restrictions, the user agents MUST:</p>
   <ul>
    <li data-md>
     <p>Clear the stored NEL policies when the user clears their browsing data (cookies, site data, history, etc).</p>
    <li data-md>
     <p>Refuse to process Set-Cookie response headers when delivering network error reports.</p>
   </ul>
   <p>When deploying NEL the developer SHOULD consider privacy implications of NEL reports delivered to the specified collectors. For example, reports may contain URLs with sensitive data (e.g. "Capability URLs") that may need special precautions (see <a data-link-type="biblio" href="#biblio-capability-urls" title="Good Practices for Capability URLs">[CAPABILITY-URLS]</a>), and may require the developer to operate their own NEL collectors to prevent reporting of such URLs to third parties.</p>
   <h2 class="heading settled" data-level="10" id="iana-considerations"><span class="secno">10. </span><span class="content">IANA Considerations</span><a class="self-link" href="#iana-considerations"></a></h2>
   <p>The permanent message header field registry should be updated with the following registrations (<a data-link-type="biblio" href="#biblio-rfc3864" title="Registration Procedures for Message Header Fields">[RFC3864]</a>):</p>
   <h3 class="heading settled" data-level="10.1" id="iana-nel"><span class="secno">10.1. </span><span class="content"><code>NEL</code></span><a class="self-link" href="#iana-nel"></a></h3>
   <dl>
    <dt data-md>Header field name
    <dd data-md>
     <p><code>NEL</code></p>
    <dt data-md>Applicable protocol
    <dd data-md>
     <p>http</p>
    <dt data-md>Status
    <dd data-md>
     <p>standard</p>
    <dt data-md>Author/Change controller
    <dd data-md>
     <p>W3C</p>
    <dt data-md>Specification document
    <dd data-md>
     <p>This specification (see <a data-link-type="dfn" href="#nel" id="ref-for-nel⑥">NEL</a> response header)</p>
   </dl>
   <h2 class="heading settled" data-level="11" id="acknowledgments"><span class="secno">11. </span><span class="content">Acknowledgments</span><a class="self-link" href="#acknowledgments"></a></h2>
   <p>This document reuses text from the <a data-link-type="biblio" href="#biblio-csp" title="Content Security Policy Level 3">[CSP]</a> and <a data-link-type="biblio" href="#biblio-rfc6797" title="HTTP Strict Transport Security (HSTS)">[RFC6797]</a> specification, as permitted by the licenses of those specifications. Additionally, sincere thanks to Julia Tuttle, Chris Bentzel, Todd Reifsteck, Aaron Heady, and Mark Nottingham for their helpful comments and contributions to this work.</p>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content">Conformance</span><a class="self-link" href="#w3c-conformance"></a></h2>
   <h3 class="no-ref no-num heading settled" id="w3c-conventions"><span class="content">Document conventions</span><a class="self-link" href="#w3c-conventions"></a></h3>
   <p>Conformance requirements are expressed
    with a combination of descriptive assertions
    and RFC 2119 terminology.
    The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
    in the normative parts of this document
    are to be interpreted as described in RFC 2119.
    However, for readability,
    these words do not appear in all uppercase letters in this specification. </p>
   <p>All of the text of this specification is normative
    except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a> </p>
   <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text
    with <code>class="example"</code>,
    like this: </p>
   <div class="example" id="w3c-example">
    <a class="self-link" href="#w3c-example"></a> 
    <p>This is an example of an informative example. </p>
   </div>
   <p>Informative notes begin with the word “Note”
    and are set apart from the normative text
    with <code>class="note"</code>,
    like this: </p>
   <p class="note" role="note">Note, this is an informative note.</p>
   <section>
    <h3 class="no-ref no-num heading settled" id="w3c-conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#w3c-conformant-algorithms"></a></h3>
    <p>Requirements phrased in the imperative as part of algorithms
    (such as "strip any leading space characters"
    or "return false and abort these steps")
    are to be interpreted with the meaning of the key word
    ("must", "should", "may", etc)
    used in introducing the algorithm. </p>
    <p>Conformance requirements phrased as algorithms or specific steps
    can be implemented in any manner,
    so long as the end result is equivalent.
    In particular, the algorithms defined in this specification
    are intended to be easy to understand
    and are not intended to be performant.
    Implementers are encouraged to optimize. </p>
   </section>
  </div>
  <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#4xx">4xx</a><span>, in § 3.1</span>
   <li><a href="#5xx">5xx</a><span>, in § 3.1</span>
   <li><a href="#creation">creation</a><span>, in § 3.4</span>
   <li><a href="#dns-resolution">DNS resolution</a><span>, in § 3.1</span>
   <li><a href="#domain-name">domain name</a><span>, in § 5.2</span>
   <li><a href="#domain-namespace-tree">domain namespace tree</a><span>, in § 9</span>
   <li><a href="#expired">expired</a><span>, in § 3.4</span>
   <li><a href="#fail">fail</a><span>, in § 3.1</span>
   <li><a href="#failure_fraction">failure_fraction</a><span>, in § 4.1.5</span>
   <li><a href="#fail">failures</a><span>, in § 3.1</span>
   <li><a href="#failure-sampling-rate">failure sampling rate</a><span>, in § 3.5</span>
   <li><a href="#include_subdomains">include_subdomains</a><span>, in § 4.1.3</span>
   <li><a href="#max_age">max_age</a><span>, in § 4.1.2</span>
   <li><a href="#nel">NEL</a><span>, in § 4.1</span>
   <li><a href="#nel-policies">NEL policies</a><span>, in § 3.4</span>
   <li><a href="#nel-policies">NEL policy</a><span>, in § 3.4</span>
   <li><a href="#network-error-reports">network error reports</a><span>, in § 3.3</span>
   <li><a href="#network-errors">network errors</a><span>, in § 3.2</span>
   <li><a href="#network-request">network request</a><span>, in § 3.1</span>
   <li><a href="#phase">phase</a><span>, in § 3.1</span>
   <li><a href="#policy-cache">policy cache</a><span>, in § 3.6</span>
   <li><a href="#policy-origin">policy origin</a><span>, in § 3.4</span>
   <li><a href="#received-ip-address">received IP address</a><span>, in § 3.4</span>
   <li><a href="#reporting-group">reporting group</a><span>, in § 3.4</span>
   <li><a href="#report_to">report_to</a><span>, in § 4.1.1</span>
   <li><a href="#response-headers">response headers</a><span>, in § 3.4</span>
   <li><a href="#sampling-rate">sampling rate</a><span>, in § 3.5</span>
   <li><a href="#secure-connection-establishment">Secure connection establishment</a><span>, in § 3.1</span>
   <li><a href="#server">server</a><span>, in § 3.1</span>
   <li><a href="#stale">stale</a><span>, in § 3.4</span>
   <li><a href="#subdomains">subdomains</a><span>, in § 3.4</span>
   <li><a href="#succeed">succeed</a><span>, in § 3.1</span>
   <li><a href="#succeed">succeeded</a><span>, in § 3.1</span>
   <li><a href="#success_fraction">success_fraction</a><span>, in § 4.1.4</span>
   <li><a href="#succeed">successful</a><span>, in § 3.1</span>
   <li><a href="#successful-sampling-rate">successful sampling rate</a><span>, in § 3.5</span>
   <li><a href="#transmission-of-request-and-response">Transmission of request and response</a><span>, in § 3.1</span>
   <li><a href="#ttl">ttl</a><span>, in § 3.4</span>
   <li><a href="#type-phase">type-phase</a><span>, in § 3.2</span>
   <li><a href="#types">types</a><span>, in § 3.2</span>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[FETCH]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="a2a30ba8">CORS protocol</span>
     <li><span class="dfn-paneled" id="4d7b724c">CORS-preflight request</span>
     <li><span class="dfn-paneled" id="1047b417">HTTP-network fetch</span>
     <li><span class="dfn-paneled" id="f78d5b5c">origin</span>
     <li><span class="dfn-paneled" id="07582c28">referrer policy</span>
     <li><span class="dfn-paneled" id="55213b5b">request</span>
     <li><span class="dfn-paneled" id="abe352cd">reserved client</span>
     <li><span class="dfn-paneled" id="ee7bba09">response</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HR-TIME-3]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="c9a0df83">duration from</span>
     <li><span class="dfn-paneled" id="a1ed2989">unsafe current time</span>
     <li><span class="dfn-paneled" id="05de5ae3">wall clock</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="a7f83c88">determine the network partition key</span>
     <li><span class="dfn-paneled" id="8e7c0232">network partition key</span>
     <li><span class="dfn-paneled" id="1a490bf8">onLine</span>
    </ul>
   <li>
    <a data-link-type="biblio">[INFRA]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="6d19ac93">user agent</span>
    </ul>
   <li>
    <a data-link-type="biblio">[MIXED-CONTENT]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="872edfd5">mixed content</span>
    </ul>
   <li>
    <a data-link-type="biblio">[REPORTING]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="cf363990">body</span>
     <li><span class="dfn-paneled" id="63b163c1">endpoint group</span>
     <li><span class="dfn-paneled" id="15fd46e4">Generate a network report</span>
     <li><span class="dfn-paneled" id="0975416e">report</span>
     <li><span class="dfn-paneled" id="4d5cebba">report type</span>
     <li><span class="dfn-paneled" id="3c4b330a">visible to ReportingObservers</span>
    </ul>
   <li>
    <a data-link-type="biblio">[SECURE-CONTEXTS]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="75b07aa2">Is origin potentially trustworthy?</span>
     <li><span class="dfn-paneled" id="b84e54ba">potentially trustworthy origin</span>
    </ul>
   <li>
    <a data-link-type="biblio">[SVG2]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="801118f1">x</span>
    </ul>
   <li>
    <a data-link-type="biblio">[URL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="ed948033">fragment</span>
     <li><span class="dfn-paneled" id="191ae185">IP address</span>
     <li><span class="dfn-paneled" id="c0868016">path</span>
     <li><span class="dfn-paneled" id="3ab2ec8b">query</span>
     <li><span class="dfn-paneled" id="5442ea33">URL serializer</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-fetch">[FETCH]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/"><cite>Fetch Standard</cite></a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-hr-time-3">[HR-TIME-3]
   <dd>Yoav Weiss. <a href="https://w3c.github.io/hr-time/"><cite>High Resolution Time</cite></a>. URL: <a href="https://w3c.github.io/hr-time/">https://w3c.github.io/hr-time/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-mixed-content">[MIXED-CONTENT]
   <dd>Emily Stark; Mike West; Carlos IbarraLopez. <a href="https://w3c.github.io/webappsec-mixed-content/"><cite>Mixed Content</cite></a>. URL: <a href="https://w3c.github.io/webappsec-mixed-content/">https://w3c.github.io/webappsec-mixed-content/</a>
   <dt id="biblio-reporting">[REPORTING]
   <dd>Douglas Creager; Ian Clelland; Mike West. <a href="https://w3c.github.io/reporting/"><cite>Reporting API</cite></a>. URL: <a href="https://w3c.github.io/reporting/">https://w3c.github.io/reporting/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
   <dt id="biblio-secure-contexts">[SECURE-CONTEXTS]
   <dd>Mike West. <a href="https://w3c.github.io/webappsec-secure-contexts/"><cite>Secure Contexts</cite></a>. URL: <a href="https://w3c.github.io/webappsec-secure-contexts/">https://w3c.github.io/webappsec-secure-contexts/</a>
   <dt id="biblio-svg2">[SVG2]
   <dd>Amelia Bellamy-Royds; et al. <a href="https://svgwg.org/svg2-draft/"><cite>Scalable Vector Graphics (SVG) 2</cite></a>. URL: <a href="https://svgwg.org/svg2-draft/">https://svgwg.org/svg2-draft/</a>
   <dt id="biblio-url">[URL]
   <dd>Anne van Kesteren. <a href="https://url.spec.whatwg.org/"><cite>URL Standard</cite></a>. Living Standard. URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-capability-urls">[CAPABILITY-URLS]
   <dd>Jeni Tennison. <a href="https://w3ctag.github.io/capability-urls/"><cite>Good Practices for Capability URLs</cite></a>. URL: <a href="https://w3ctag.github.io/capability-urls/">https://w3ctag.github.io/capability-urls/</a>
   <dt id="biblio-csp">[CSP]
   <dd>Mike West; Antonio Sartori. <a href="https://w3c.github.io/webappsec-csp/"><cite>Content Security Policy Level 3</cite></a>. URL: <a href="https://w3c.github.io/webappsec-csp/">https://w3c.github.io/webappsec-csp/</a>
   <dt id="biblio-ecma-262">[ECMA-262]
   <dd><a href="https://tc39.es/ecma262/multipage/"><cite>ECMAScript Language Specification</cite></a>. URL: <a href="https://tc39.es/ecma262/multipage/">https://tc39.es/ecma262/multipage/</a>
   <dt id="biblio-http-jfv">[HTTP-JFV]
   <dd>J. Reschke. <a href="https://datatracker.ietf.org/doc/html/draft-reschke-http-jfv"><cite>A JSON Encoding for HTTP Header Field Values</cite></a>. 24 October 2017. Active Internet-Draft. URL: <a href="https://datatracker.ietf.org/doc/html/draft-reschke-http-jfv">https://datatracker.ietf.org/doc/html/draft-reschke-http-jfv</a>
   <dt id="biblio-resource-timing-2">[RESOURCE-TIMING-2]
   <dd>Yoav Weiss; Noam Rosenthal. <a href="https://w3c.github.io/resource-timing/"><cite>Resource Timing</cite></a>. URL: <a href="https://w3c.github.io/resource-timing/">https://w3c.github.io/resource-timing/</a>
   <dt id="biblio-rfc1034">[RFC1034]
   <dd>P. Mockapetris. <a href="https://www.rfc-editor.org/rfc/rfc1034"><cite>Domain names - concepts and facilities</cite></a>. November 1987. Internet Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc1034">https://www.rfc-editor.org/rfc/rfc1034</a>
   <dt id="biblio-rfc1123">[RFC1123]
   <dd>R. Braden, Ed.. <a href="https://www.rfc-editor.org/rfc/rfc1123"><cite>Requirements for Internet Hosts - Application and Support</cite></a>. October 1989. Internet Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc1123">https://www.rfc-editor.org/rfc/rfc1123</a>
   <dt id="biblio-rfc3864">[RFC3864]
   <dd>G. Klyne; M. Nottingham; J. Mogul. <a href="https://www.rfc-editor.org/rfc/rfc3864"><cite>Registration Procedures for Message Header Fields</cite></a>. September 2004. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc3864">https://www.rfc-editor.org/rfc/rfc3864</a>
   <dt id="biblio-rfc4291">[RFC4291]
   <dd>R. Hinden; S. Deering. <a href="https://www.rfc-editor.org/rfc/rfc4291"><cite>IP Version 6 Addressing Architecture</cite></a>. February 2006. Draft Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc4291">https://www.rfc-editor.org/rfc/rfc4291</a>
   <dt id="biblio-rfc5234">[RFC5234]
   <dd>D. Crocker, Ed.; P. Overell. <a href="https://www.rfc-editor.org/rfc/rfc5234"><cite>Augmented BNF for Syntax Specifications: ABNF</cite></a>. January 2008. Internet Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc5234">https://www.rfc-editor.org/rfc/rfc5234</a>
   <dt id="biblio-rfc6797">[RFC6797]
   <dd>J. Hodges; C. Jackson; A. Barth. <a href="https://www.rfc-editor.org/rfc/rfc6797"><cite>HTTP Strict Transport Security (HSTS)</cite></a>. November 2012. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc6797">https://www.rfc-editor.org/rfc/rfc6797</a>
   <dt id="biblio-rfc9110">[RFC9110]
   <dd>R. Fielding, Ed.; M. Nottingham, Ed.; J. Reschke, Ed.. <a href="https://httpwg.org/specs/rfc9110.html"><cite>HTTP Semantics</cite></a>. June 2022. Internet Standard. URL: <a href="https://httpwg.org/specs/rfc9110.html">https://httpwg.org/specs/rfc9110.html</a>
   <dt id="biblio-rfc9112">[RFC9112]
   <dd>R. Fielding, Ed.; M. Nottingham, Ed.; J. Reschke, Ed.. <a href="https://httpwg.org/specs/rfc9112.html"><cite>HTTP/1.1</cite></a>. June 2022. Internet Standard. URL: <a href="https://httpwg.org/specs/rfc9112.html">https://httpwg.org/specs/rfc9112.html</a>
   <dt id="biblio-rfc9651">[RFC9651]
   <dd>M. Nottingham; P-H. Kamp. <a href="https://www.rfc-editor.org/rfc/rfc9651"><cite>Structured Field Values for HTTP</cite></a>. September 2024. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc9651">https://www.rfc-editor.org/rfc/rfc9651</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> We would like to move the definition of these <a data-link-type="dfn" href="#phase">phases</a> into <a data-link-type="biblio" href="#biblio-fetch" title="Fetch Standard">[FETCH]</a> so that they are more reusable. <a class="issue-return" href="#issue-95f7f578" title="Jump to section">↵</a></div>
   <div class="issue"> Plumb this through more explicitly in <a data-link-type="biblio" href="#biblio-fetch" title="Fetch Standard">[FETCH]</a>. <a class="issue-return" href="#issue-b2720c5c" title="Jump to section">↵</a></div>
  </div>
  <details class="mdn-anno unpositioned" data-anno-for="nel-response-header">
   <summary><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></summary>
   <div class="feature">
    <p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/NEL" title="The HTTP NEL response header is used to configure network request logging.">Headers/NEL</a></p>
    <p class="less-than-two-engines-text">In only one current engine.</p>
    <div class="support">
     <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome yes"><span>Chrome</span><span>71+</span></span>
     <hr>
     <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
     <hr>
     <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>IE</span><span>None</span></span>
     <hr>
     <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>10.2+</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
    </div>
   </div>
  </details>
<script>/* Boilerplate: script-dom-helper */
"use strict";
function query(sel) { return document.querySelector(sel); }

function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

function iter(obj) {
	if(!obj) return [];
	var it = obj[Symbol.iterator];
	if(it) return it;
	return Object.entries(obj);
}

function mk(tagname, attrs, ...children) {
	const el = document.createElement(tagname);
	for(const [k,v] of iter(attrs)) {
		if(k.slice(0,3) == "_on") {
			const eventName = k.slice(3);
			el.addEventListener(eventName, v);
		} else if(k[0] == "_") {
			// property, not attribute
			el[k.slice(1)] = v;
		} else {
			if(v === false || v == null) {
        continue;
      } else if(v === true) {
        el.setAttribute(k, "");
        continue;
      } else {
  			el.setAttribute(k, v);
      }
		}
	}
	append(el, children);
	return el;
}

/* Create shortcuts for every known HTML element */
[
  "a",
  "abbr",
  "acronym",
  "address",
  "applet",
  "area",
  "article",
  "aside",
  "audio",
  "b",
  "base",
  "basefont",
  "bdo",
  "big",
  "blockquote",
  "body",
  "br",
  "button",
  "canvas",
  "caption",
  "center",
  "cite",
  "code",
  "col",
  "colgroup",
  "datalist",
  "dd",
  "del",
  "details",
  "dfn",
  "dialog",
  "div",
  "dl",
  "dt",
  "em",
  "embed",
  "fieldset",
  "figcaption",
  "figure",
  "font",
  "footer",
  "form",
  "frame",
  "frameset",
  "head",
  "header",
  "h1",
  "h2",
  "h3",
  "h4",
  "h5",
  "h6",
  "hr",
  "html",
  "i",
  "iframe",
  "img",
  "input",
  "ins",
  "kbd",
  "label",
  "legend",
  "li",
  "link",
  "main",
  "map",
  "mark",
  "meta",
  "meter",
  "nav",
  "nobr",
  "noscript",
  "object",
  "ol",
  "optgroup",
  "option",
  "output",
  "p",
  "param",
  "pre",
  "progress",
  "q",
  "s",
  "samp",
  "script",
  "section",
  "select",
  "small",
  "source",
  "span",
  "strike",
  "strong",
  "style",
  "sub",
  "summary",
  "sup",
  "table",
  "tbody",
  "td",
  "template",
  "textarea",
  "tfoot",
  "th",
  "thead",
  "time",
  "title",
  "tr",
  "u",
  "ul",
  "var",
  "video",
  "wbr",
  "xmp",
].forEach(tagname=>{
	mk[tagname] = (...args) => mk(tagname, ...args);
});

function* nodesFromChildList(children) {
	for(const child of children.flat(Infinity)) {
		if(child instanceof Node) {
			yield child;
		} else {
			yield new Text(child);
		}
	}
}
function append(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		if(el instanceof Node) el.appendChild(child);
		else el.push(child);
	}
	return el;
}

function insertAfter(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		el.parentNode.insertBefore(child, el.nextSibling);
	}
	return el;
}

function clearContents(el) {
	el.innerHTML = "";
	return el;
}

function parseHTML(markup) {
	if(markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
		const doc = document.implementation.createHTMLDocument("");
		doc.documentElement.innerHTML = markup;
		return doc;
	} else {
		const el = mk.template({});
		el.innerHTML = markup;
		return el.content;
	}
}</script>
<script>/* Boilerplate: script-dfn-panel */
"use strict";
{
let dfnPanelData = {
"05de5ae3": {"dfnID":"05de5ae3","dfnText":"wall clock","external":true,"refSections":[{"refs":[{"id":"ref-for-dfn-wall-clock"},{"id":"ref-for-dfn-wall-clock\u2460"}],"title":"3.4. NEL policies"},{"refs":[{"id":"ref-for-dfn-wall-clock\u2461"}],"title":"4.2. Process policy headers"}],"url":"https://w3c.github.io/hr-time/#dfn-wall-clock"},
"07582c28": {"dfnID":"07582c28","dfnText":"referrer policy","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-referrer-policy"}],"title":"5.2. Generate a network error report"}],"url":"https://fetch.spec.whatwg.org/#concept-request-referrer-policy"},
"0975416e": {"dfnID":"0975416e","dfnText":"report","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-report"}],"title":"3.3. Network error reports"},{"refs":[{"id":"ref-for-concept-report\u2460"},{"id":"ref-for-concept-report\u2461"}],"title":"7.2. Sample Network Error Reports"}],"url":"https://w3c.github.io/reporting/#concept-report"},
"1047b417": {"dfnID":"1047b417","dfnText":"HTTP-network fetch","external":true,"refSections":[{"refs":[{"id":"ref-for-http-network-fetch"},{"id":"ref-for-http-network-fetch\u2460"}],"title":"3.1. Network requests"}],"url":"https://fetch.spec.whatwg.org/#http-network-fetch"},
"15fd46e4": {"dfnID":"15fd46e4","dfnText":"Generate a network report","external":true,"refSections":[{"refs":[{"id":"ref-for-generate-a-network-report"}],"title":"5.3. Deliver a network report"}],"url":"https://w3c.github.io/reporting/#generate-a-network-report"},
"191ae185": {"dfnID":"191ae185","dfnText":"IP address","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-host-ip-address"}],"title":"3.1. Network requests"},{"refs":[{"id":"ref-for-concept-host-ip-address\u2460"}],"title":"3.4. NEL policies"},{"refs":[{"id":"ref-for-concept-host-ip-address\u2461"}],"title":"4.2. Process policy headers"}],"url":"https://url.spec.whatwg.org/#concept-host-ip-address"},
"1a490bf8": {"dfnID":"1a490bf8","dfnText":"onLine","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-navigator-online"}],"title":"3.1. Network requests"}],"url":"https://html.spec.whatwg.org/multipage/system-state.html#dom-navigator-online"},
"3ab2ec8b": {"dfnID":"3ab2ec8b","dfnText":"query","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-query"}],"title":"5.3. Deliver a network report"}],"url":"https://url.spec.whatwg.org/#concept-url-query"},
"3c4b330a": {"dfnID":"3c4b330a","dfnText":"visible to ReportingObservers","external":true,"refSections":[{"refs":[{"id":"ref-for-visible-to-reportingobservers"},{"id":"ref-for-visible-to-reportingobservers\u2460"},{"id":"ref-for-visible-to-reportingobservers\u2461"}],"title":"3.3. Network error reports"}],"url":"https://w3c.github.io/reporting/#visible-to-reportingobservers"},
"4d5cebba": {"dfnID":"4d5cebba","dfnText":"report type","external":true,"refSections":[{"refs":[{"id":"ref-for-report-type"}],"title":"3.3. Network error reports"}],"url":"https://w3c.github.io/reporting/#report-type"},
"4d7b724c": {"dfnID":"4d7b724c","dfnText":"CORS-preflight request","external":true,"refSections":[{"refs":[{"id":"ref-for-cors-preflight-request"}],"title":"3.1. Network requests"}],"url":"https://fetch.spec.whatwg.org/#cors-preflight-request"},
"4xx": {"dfnID":"4xx","dfnText":"4xx","external":false,"refSections":[{"refs":[{"id":"ref-for-4xx"}],"title":"3.1. Network requests"},{"refs":[{"id":"ref-for-4xx\u2460"}],"title":"6.3. Transmission of request and response errors"}],"url":"#4xx"},
"5442ea33": {"dfnID":"5442ea33","dfnText":"URL serializer","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-serializer"}],"title":"5.3. Deliver a network report"}],"url":"https://url.spec.whatwg.org/#concept-url-serializer"},
"55213b5b": {"dfnID":"55213b5b","dfnText":"request","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request"},{"id":"ref-for-concept-request\u2460"},{"id":"ref-for-concept-request\u2461"},{"id":"ref-for-concept-request\u2462"},{"id":"ref-for-concept-request\u2463"},{"id":"ref-for-concept-request\u2464"}],"title":"3.1. Network requests"},{"refs":[{"id":"ref-for-concept-request\u2465"}],"title":"5.2. Generate a network error report"},{"refs":[{"id":"ref-for-concept-request\u2466"},{"id":"ref-for-concept-request\u2467"},{"id":"ref-for-concept-request\u2468"},{"id":"ref-for-concept-request\u2460\u24ea"},{"id":"ref-for-concept-request\u2460\u2460"},{"id":"ref-for-concept-request\u2460\u2461"}],"title":"7.4. Origins with multiple IP addresses"},{"refs":[{"id":"ref-for-concept-request\u2460\u2462"},{"id":"ref-for-concept-request\u2460\u2463"},{"id":"ref-for-concept-request\u2460\u2464"},{"id":"ref-for-concept-request\u2460\u2465"},{"id":"ref-for-concept-request\u2460\u2466"},{"id":"ref-for-concept-request\u2460\u2467"}],"title":"9. Privacy Considerations"}],"url":"https://fetch.spec.whatwg.org/#concept-request"},
"5xx": {"dfnID":"5xx","dfnText":"5xx","external":false,"refSections":[{"refs":[{"id":"ref-for-5xx"}],"title":"3.1. Network requests"},{"refs":[{"id":"ref-for-5xx\u2460"}],"title":"6.3. Transmission of request and response errors"}],"url":"#5xx"},
"63b163c1": {"dfnID":"63b163c1","dfnText":"endpoint group","external":true,"refSections":[{"refs":[{"id":"ref-for-endpoint-group"}],"title":"3.4. NEL policies"},{"refs":[{"id":"ref-for-endpoint-group\u2460"},{"id":"ref-for-endpoint-group\u2461"}],"title":"4.1.1. The report_to member"},{"refs":[{"id":"ref-for-endpoint-group\u2462"}],"title":"4.1.2. The max_age member"},{"refs":[{"id":"ref-for-endpoint-group\u2463"}],"title":"4.1.3. The include_subdomains member"},{"refs":[{"id":"ref-for-endpoint-group\u2464"}],"title":"7.1. Sample Policy Definitions"}],"url":"https://w3c.github.io/reporting/#endpoint-group"},
"6d19ac93": {"dfnID":"6d19ac93","dfnText":"user agent","external":true,"refSections":[{"refs":[{"id":"ref-for-user-agent"}],"title":"3.1. Network requests"}],"url":"https://infra.spec.whatwg.org/#user-agent"},
"75b07aa2": {"dfnID":"75b07aa2","dfnText":"Is origin potentially trustworthy?","external":true,"refSections":[{"refs":[{"id":"ref-for-is-origin-trustworthy"}],"title":"4.2. Process policy headers"},{"refs":[{"id":"ref-for-is-origin-trustworthy\u2460"}],"title":"5.2. Generate a network error report"}],"url":"https://www.w3.org/TR/secure-contexts/#is-origin-trustworthy"},
"801118f1": {"dfnID":"801118f1","dfnText":"x","external":true,"refSections":[{"refs":[{"id":"ref-for-XProperty"}],"title":"5.2. Generate a network error report"}],"url":"https://svgwg.org/svg2-draft/geometry.html#XProperty"},
"872edfd5": {"dfnID":"872edfd5","dfnText":"mixed content","external":true,"refSections":[{"refs":[{"id":"ref-for-mixed-content"}],"title":"3.1. Network requests"}],"url":"https://w3c.github.io/webappsec-mixed-content/#mixed-content"},
"8e7c0232": {"dfnID":"8e7c0232","dfnText":"network partition key","external":true,"refSections":[{"refs":[{"id":"ref-for-network-partition-key"}],"title":"3.1. Network requests"},{"refs":[{"id":"ref-for-network-partition-key\u2460"},{"id":"ref-for-network-partition-key\u2461"}],"title":"3.6. Policy cache"},{"refs":[{"id":"ref-for-network-partition-key\u2462"}],"title":"9. Privacy Considerations"}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#network-partition-key"},
"a1ed2989": {"dfnID":"a1ed2989","dfnText":"unsafe current time","external":true,"refSections":[{"refs":[{"id":"ref-for-dfn-unsafe-current-time"},{"id":"ref-for-dfn-unsafe-current-time\u2460"}],"title":"3.4. NEL policies"},{"refs":[{"id":"ref-for-dfn-unsafe-current-time\u2461"}],"title":"4.2. Process policy headers"}],"url":"https://w3c.github.io/hr-time/#dfn-unsafe-current-time"},
"a2a30ba8": {"dfnID":"a2a30ba8","dfnText":"CORS protocol","external":true,"refSections":[{"refs":[{"id":"ref-for-cors-protocol"}],"title":"3.1. Network requests"}],"url":"https://fetch.spec.whatwg.org/#cors-protocol"},
"a7f83c88": {"dfnID":"a7f83c88","dfnText":"determine the network partition key","external":true,"refSections":[{"refs":[{"id":"ref-for-determine-the-network-partition-key"}],"title":"4.2. Process policy headers"},{"refs":[{"id":"ref-for-determine-the-network-partition-key\u2460"}],"title":"5.1. Choose a policy for a request"}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#determine-the-network-partition-key"},
"abe352cd": {"dfnID":"abe352cd","dfnText":"reserved client","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-reserved-client"}],"title":"4.2. Process policy headers"},{"refs":[{"id":"ref-for-concept-request-reserved-client\u2460"}],"title":"5.1. Choose a policy for a request"}],"url":"https://fetch.spec.whatwg.org/#concept-request-reserved-client"},
"b84e54ba": {"dfnID":"b84e54ba","dfnText":"potentially trustworthy origin","external":true,"refSections":[{"refs":[{"id":"ref-for-potentially-trustworthy-origin"}],"title":"7.1. Sample Policy Definitions"},{"refs":[{"id":"ref-for-potentially-trustworthy-origin\u2460"},{"id":"ref-for-potentially-trustworthy-origin\u2461"}],"title":"9. Privacy Considerations"}],"url":"https://www.w3.org/TR/secure-contexts/#potentially-trustworthy-origin"},
"c0868016": {"dfnID":"c0868016","dfnText":"path","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-path"}],"title":"5.3. Deliver a network report"}],"url":"https://url.spec.whatwg.org/#concept-url-path"},
"c9a0df83": {"dfnID":"c9a0df83","dfnText":"duration from","external":true,"refSections":[{"refs":[{"id":"ref-for-dfn-duration-from"},{"id":"ref-for-dfn-duration-from\u2460"}],"title":"3.4. NEL policies"}],"url":"https://w3c.github.io/hr-time/#dfn-duration-from"},
"cf363990": {"dfnID":"cf363990","dfnText":"body","external":true,"refSections":[{"refs":[{"id":"ref-for-report-body"}],"title":"7.2. Sample Network Error Reports"},{"refs":[{"id":"ref-for-report-body\u2460"}],"title":"9. Privacy Considerations"}],"url":"https://w3c.github.io/reporting/#report-body"},
"creation": {"dfnID":"creation","dfnText":"creation","external":false,"refSections":[{"refs":[{"id":"ref-for-creation"},{"id":"ref-for-creation\u2460"}],"title":"3.4. NEL policies"},{"refs":[{"id":"ref-for-creation\u2461"}],"title":"4.2. Process policy headers"}],"url":"#creation"},
"dns-resolution": {"dfnID":"dns-resolution","dfnText":"DNS resolution","external":false,"refSections":[{"refs":[{"id":"ref-for-dns-resolution"}],"title":"3.1. Network requests"},{"refs":[{"id":"ref-for-dns-resolution\u2460"}],"title":"3.2. Network errors"},{"refs":[{"id":"ref-for-dns-resolution\u2461"},{"id":"ref-for-dns-resolution\u2462"},{"id":"ref-for-dns-resolution\u2463"}],"title":"5.2. Generate a network error report"},{"refs":[{"id":"ref-for-dns-resolution\u2464"}],"title":"6.1. DNS resolution errors"},{"refs":[{"id":"ref-for-dns-resolution\u2465"},{"id":"ref-for-dns-resolution\u2466"},{"id":"ref-for-dns-resolution\u2467"}],"title":"9. Privacy Considerations"}],"url":"#dns-resolution"},
"domain-name": {"dfnID":"domain-name","dfnText":"domain name","external":false,"refSections":[{"refs":[{"id":"ref-for-domain-name"}],"title":"5.2. Generate a network error report"},{"refs":[{"id":"ref-for-domain-name\u2460"}],"title":"7.4. Origins with multiple IP addresses"},{"refs":[{"id":"ref-for-domain-name\u2461"}],"title":"9. Privacy Considerations"}],"url":"#domain-name"},
"domain-namespace-tree": {"dfnID":"domain-namespace-tree","dfnText":"domain namespace tree","external":false,"refSections":[{"refs":[{"id":"ref-for-domain-namespace-tree"}],"title":"9. Privacy Considerations"}],"url":"#domain-namespace-tree"},
"ed948033": {"dfnID":"ed948033","dfnText":"fragment","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-fragment"}],"title":"5.3. Deliver a network report"}],"url":"https://url.spec.whatwg.org/#concept-url-fragment"},
"ee7bba09": {"dfnID":"ee7bba09","dfnText":"response","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-response"}],"title":"3.1. Network requests"},{"refs":[{"id":"ref-for-concept-response\u2460"}],"title":"4.2. Process policy headers"},{"refs":[{"id":"ref-for-concept-response\u2461"}],"title":"5.2. Generate a network error report"},{"refs":[{"id":"ref-for-concept-response\u2462"},{"id":"ref-for-concept-response\u2463"}],"title":"7.4. Origins with multiple IP addresses"}],"url":"https://fetch.spec.whatwg.org/#concept-response"},
"expired": {"dfnID":"expired","dfnText":"expired","external":false,"refSections":[{"refs":[{"id":"ref-for-expired"},{"id":"ref-for-expired\u2460"}],"title":"5.1. Choose a policy for a request"}],"url":"#expired"},
"f78d5b5c": {"dfnID":"f78d5b5c","dfnText":"origin","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-origin"}],"title":"3.4. NEL policies"},{"refs":[{"id":"ref-for-concept-request-origin\u2460"}],"title":"3.5. Sampling rates"},{"refs":[{"id":"ref-for-concept-request-origin\u2461"},{"id":"ref-for-concept-request-origin\u2462"}],"title":"3.6. Policy cache"},{"refs":[{"id":"ref-for-concept-request-origin\u2463"}],"title":"4.1. NEL response header"},{"refs":[{"id":"ref-for-concept-request-origin\u2464"}],"title":"4.1.2. The max_age member"},{"refs":[{"id":"ref-for-concept-request-origin\u2465"},{"id":"ref-for-concept-request-origin\u2466"},{"id":"ref-for-concept-request-origin\u2467"},{"id":"ref-for-concept-request-origin\u2468"}],"title":"4.2. Process policy headers"},{"refs":[{"id":"ref-for-concept-request-origin\u2460\u24ea"}],"title":"5.1. Choose a policy for a request"},{"refs":[{"id":"ref-for-concept-request-origin\u2460\u2460"},{"id":"ref-for-concept-request-origin\u2460\u2461"},{"id":"ref-for-concept-request-origin\u2460\u2462"}],"title":"5.2. Generate a network error report"},{"refs":[{"id":"ref-for-concept-request-origin\u2460\u2463"}],"title":"6.1. DNS resolution errors"},{"refs":[{"id":"ref-for-concept-request-origin\u2460\u2464"}],"title":"7.2. Sample Network Error Reports"},{"refs":[{"id":"ref-for-concept-request-origin\u2460\u2465"},{"id":"ref-for-concept-request-origin\u2460\u2466"}],"title":"7.4. Origins with multiple IP addresses"},{"refs":[{"id":"ref-for-concept-request-origin\u2460\u2467"}],"title":"8.2. Reporting of First-party Subresource Fetch Failures"},{"refs":[{"id":"ref-for-concept-request-origin\u2460\u2468"}],"title":"8.3. Reporting of Third-party Subresource Fetch Failures"},{"refs":[{"id":"ref-for-concept-request-origin\u2461\u24ea"}],"title":"9. Privacy Considerations"}],"url":"https://fetch.spec.whatwg.org/#concept-request-origin"},
"fail": {"dfnID":"fail","dfnText":"failed","external":false,"refSections":[{"refs":[{"id":"ref-for-fail"}],"title":"3.1. Network requests"},{"refs":[{"id":"ref-for-fail\u2460"}],"title":"3.2. Network errors"},{"refs":[{"id":"ref-for-fail\u2461"}],"title":"3.5. Sampling rates"},{"refs":[{"id":"ref-for-fail\u2462"},{"id":"ref-for-fail\u2463"}],"title":"4.1.5. The failure_fraction member"},{"refs":[{"id":"ref-for-fail\u2464"},{"id":"ref-for-fail\u2465"},{"id":"ref-for-fail\u2466"}],"title":"5.2. Generate a network error report"},{"refs":[{"id":"ref-for-fail\u2467"}],"title":"7.4. Origins with multiple IP addresses"}],"url":"#fail"},
"failure-sampling-rate": {"dfnID":"failure-sampling-rate","dfnText":"failure sampling rate","external":false,"refSections":[{"refs":[{"id":"ref-for-failure-sampling-rate"}],"title":"3.1. Network requests"},{"refs":[{"id":"ref-for-failure-sampling-rate\u2460"}],"title":"4.2. Process policy headers"},{"refs":[{"id":"ref-for-failure-sampling-rate\u2461"}],"title":"5.2. Generate a network error report"}],"url":"#failure-sampling-rate"},
"failure_fraction": {"dfnID":"failure_fraction","dfnText":"failure_fraction","external":false,"refSections":[{"refs":[{"id":"ref-for-failure_fraction"},{"id":"ref-for-failure_fraction\u2460"}],"title":"4.2. Process policy headers"}],"url":"#failure_fraction"},
"include_subdomains": {"dfnID":"include_subdomains","dfnText":"include_subdomains","external":false,"refSections":[{"refs":[{"id":"ref-for-include_subdomains"}],"title":"4.2. Process policy headers"}],"url":"#include_subdomains"},
"max_age": {"dfnID":"max_age","dfnText":"max_age","external":false,"refSections":[{"refs":[{"id":"ref-for-max_age"}],"title":"4.1.1. The report_to member"},{"refs":[{"id":"ref-for-max_age\u2460"},{"id":"ref-for-max_age\u2461"},{"id":"ref-for-max_age\u2462"}],"title":"4.2. Process policy headers"}],"url":"#max_age"},
"nel": {"dfnID":"nel","dfnText":"NEL","external":false,"refSections":[{"refs":[{"id":"ref-for-nel"}],"title":"1. Introduction"},{"refs":[{"id":"ref-for-nel\u2460"}],"title":"4. Policy delivery"},{"refs":[{"id":"ref-for-nel\u2461"},{"id":"ref-for-nel\u2462"},{"id":"ref-for-nel\u2463"},{"id":"ref-for-nel\u2464"}],"title":"4.1. NEL response header"},{"refs":[{"id":"ref-for-nel\u2465"}],"title":"10.1. NEL"}],"url":"#nel"},
"nel-policies": {"dfnID":"nel-policies","dfnText":"NEL policy","external":false,"refSections":[{"refs":[{"id":"ref-for-nel-policies"}],"title":"1. Introduction"},{"refs":[{"id":"ref-for-nel-policies\u2460"}],"title":"3.1. Network requests"},{"refs":[{"id":"ref-for-nel-policies\u2461"},{"id":"ref-for-nel-policies\u2462"},{"id":"ref-for-nel-policies\u2463"},{"id":"ref-for-nel-policies\u2464"},{"id":"ref-for-nel-policies\u2465"},{"id":"ref-for-nel-policies\u2466"},{"id":"ref-for-nel-policies\u2467"},{"id":"ref-for-nel-policies\u2468"},{"id":"ref-for-nel-policies\u2460\u24ea"},{"id":"ref-for-nel-policies\u2460\u2460"}],"title":"3.4. NEL policies"},{"refs":[{"id":"ref-for-nel-policies\u2460\u2461"},{"id":"ref-for-nel-policies\u2460\u2462"}],"title":"3.5. Sampling rates"},{"refs":[{"id":"ref-for-nel-policies\u2460\u2463"},{"id":"ref-for-nel-policies\u2460\u2464"},{"id":"ref-for-nel-policies\u2460\u2465"}],"title":"3.6. Policy cache"},{"refs":[{"id":"ref-for-nel-policies\u2460\u2466"}],"title":"4. Policy delivery"},{"refs":[{"id":"ref-for-nel-policies\u2460\u2467"},{"id":"ref-for-nel-policies\u2460\u2468"},{"id":"ref-for-nel-policies\u2461\u24ea"}],"title":"4.1. NEL response header"},{"refs":[{"id":"ref-for-nel-policies\u2461\u2460"},{"id":"ref-for-nel-policies\u2461\u2461"}],"title":"4.1.1. The report_to member"},{"refs":[{"id":"ref-for-nel-policies\u2461\u2462"},{"id":"ref-for-nel-policies\u2461\u2463"}],"title":"4.1.2. The max_age member"},{"refs":[{"id":"ref-for-nel-policies\u2461\u2464"},{"id":"ref-for-nel-policies\u2461\u2465"}],"title":"4.1.3. The include_subdomains member"},{"refs":[{"id":"ref-for-nel-policies\u2461\u2466"},{"id":"ref-for-nel-policies\u2461\u2467"},{"id":"ref-for-nel-policies\u2461\u2468"}],"title":"4.2. Process policy headers"},{"refs":[{"id":"ref-for-nel-policies\u2462\u24ea"}],"title":"5.1. Choose a policy for a request"},{"refs":[{"id":"ref-for-nel-policies\u2462\u2460"},{"id":"ref-for-nel-policies\u2462\u2461"},{"id":"ref-for-nel-policies\u2462\u2462"},{"id":"ref-for-nel-policies\u2462\u2463"}],"title":"5.2. Generate a network error report"},{"refs":[{"id":"ref-for-nel-policies\u2462\u2464"}],"title":"5.3. Deliver a network report"},{"refs":[{"id":"ref-for-nel-policies\u2462\u2465"}],"title":"6.1. DNS resolution errors"},{"refs":[{"id":"ref-for-nel-policies\u2462\u2466"},{"id":"ref-for-nel-policies\u2462\u2467"}],"title":"7.1. Sample Policy Definitions"},{"refs":[{"id":"ref-for-nel-policies\u2462\u2468"},{"id":"ref-for-nel-policies\u2463\u24ea"}],"title":"7.2. Sample Network Error Reports"},{"refs":[{"id":"ref-for-nel-policies\u2463\u2460"},{"id":"ref-for-nel-policies\u2463\u2461"},{"id":"ref-for-nel-policies\u2463\u2462"},{"id":"ref-for-nel-policies\u2463\u2463"},{"id":"ref-for-nel-policies\u2463\u2464"}],"title":"7.4. Origins with multiple IP addresses"},{"refs":[{"id":"ref-for-nel-policies\u2463\u2465"}],"title":"8.1. Reporting of Navigation Failures"},{"refs":[{"id":"ref-for-nel-policies\u2463\u2466"},{"id":"ref-for-nel-policies\u2463\u2467"}],"title":"8.2. Reporting of First-party Subresource Fetch Failures"},{"refs":[{"id":"ref-for-nel-policies\u2463\u2468"}],"title":"8.3. Reporting of Third-party Subresource Fetch Failures"},{"refs":[{"id":"ref-for-nel-policies\u2464\u24ea"},{"id":"ref-for-nel-policies\u2464\u2460"},{"id":"ref-for-nel-policies\u2464\u2461"},{"id":"ref-for-nel-policies\u2464\u2462"},{"id":"ref-for-nel-policies\u2464\u2463"},{"id":"ref-for-nel-policies\u2464\u2464"},{"id":"ref-for-nel-policies\u2464\u2465"}],"title":"9. Privacy Considerations"}],"url":"#nel-policies"},
"network-error-reports": {"dfnID":"network-error-reports","dfnText":"network error report","external":false,"refSections":[{"refs":[{"id":"ref-for-network-error-reports"},{"id":"ref-for-network-error-reports\u2460"},{"id":"ref-for-network-error-reports\u2461"}],"title":"3.3. Network error reports"}],"url":"#network-error-reports"},
"network-errors": {"dfnID":"network-errors","dfnText":"network error","external":false,"refSections":[{"refs":[{"id":"ref-for-network-errors"},{"id":"ref-for-network-errors\u2460"},{"id":"ref-for-network-errors\u2461"}],"title":"3.2. Network errors"},{"refs":[{"id":"ref-for-network-errors\u2462"}],"title":"3.3. Network error reports"},{"refs":[{"id":"ref-for-network-errors\u2463"},{"id":"ref-for-network-errors\u2464"}],"title":"5.2. Generate a network error report"},{"refs":[{"id":"ref-for-network-errors\u2465"},{"id":"ref-for-network-errors\u2466"}],"title":"6. Predefined network error types"},{"refs":[{"id":"ref-for-network-errors\u2467"}],"title":"6.1. DNS resolution errors"},{"refs":[{"id":"ref-for-network-errors\u2468"}],"title":"6.2. Secure connection establishment errors"},{"refs":[{"id":"ref-for-network-errors\u2460\u24ea"}],"title":"6.3. Transmission of request and response errors"},{"refs":[{"id":"ref-for-network-errors\u2460\u2460"},{"id":"ref-for-network-errors\u2460\u2461"},{"id":"ref-for-network-errors\u2460\u2462"},{"id":"ref-for-network-errors\u2460\u2463"}],"title":"7.2. Sample Network Error Reports"}],"url":"#network-errors"},
"network-request": {"dfnID":"network-request","dfnText":"network request","external":false,"refSections":[{"refs":[{"id":"ref-for-network-request"},{"id":"ref-for-network-request\u2460"},{"id":"ref-for-network-request\u2461"},{"id":"ref-for-network-request\u2462"},{"id":"ref-for-network-request\u2463"},{"id":"ref-for-network-request\u2464"},{"id":"ref-for-network-request\u2465"},{"id":"ref-for-network-request\u2466"}],"title":"3.1. Network requests"},{"refs":[{"id":"ref-for-network-request\u2467"}],"title":"3.2. Network errors"},{"refs":[{"id":"ref-for-network-request\u2468"}],"title":"3.4. NEL policies"},{"refs":[{"id":"ref-for-network-request\u2460\u24ea"}],"title":"3.5. Sampling rates"},{"refs":[{"id":"ref-for-network-request\u2460\u2460"},{"id":"ref-for-network-request\u2460\u2461"}],"title":"4.1.4. The success_fraction member"},{"refs":[{"id":"ref-for-network-request\u2460\u2462"},{"id":"ref-for-network-request\u2460\u2463"}],"title":"4.1.5. The failure_fraction member"},{"refs":[{"id":"ref-for-network-request\u2460\u2464"}],"title":"4.2. Process policy headers"},{"refs":[{"id":"ref-for-network-request\u2460\u2465"},{"id":"ref-for-network-request\u2460\u2466"}],"title":"5.1. Choose a policy for a request"},{"refs":[{"id":"ref-for-network-request\u2460\u2467"}],"title":"5.2. Generate a network error report"},{"refs":[{"id":"ref-for-network-request\u2460\u2468"}],"title":"5.3. Deliver a network report"},{"refs":[{"id":"ref-for-network-request\u2461\u24ea"}],"title":"7.4. Origins with multiple IP addresses"}],"url":"#network-request"},
"phase": {"dfnID":"phase","dfnText":"phases","external":false,"refSections":[{"refs":[{"id":"ref-for-phase"},{"id":"ref-for-phase\u2460"},{"id":"ref-for-phase\u2461"},{"id":"ref-for-phase\u2462"}],"title":"3.1. Network requests"},{"refs":[{"id":"ref-for-phase\u2463"}],"title":"3.2. Network errors"},{"refs":[{"id":"ref-for-phase\u2464"}],"title":"5.2. Generate a network error report"},{"refs":[{"id":"ref-for-phase\u2465"},{"id":"ref-for-phase\u2466"}],"title":"9. Privacy Considerations"}],"url":"#phase"},
"policy-cache": {"dfnID":"policy-cache","dfnText":"policy cache","external":false,"refSections":[{"refs":[{"id":"ref-for-policy-cache"}],"title":"4.1.2. The max_age member"},{"refs":[{"id":"ref-for-policy-cache\u2460"},{"id":"ref-for-policy-cache\u2461"},{"id":"ref-for-policy-cache\u2462"},{"id":"ref-for-policy-cache\u2463"}],"title":"4.2. Process policy headers"},{"refs":[{"id":"ref-for-policy-cache\u2464"},{"id":"ref-for-policy-cache\u2465"},{"id":"ref-for-policy-cache\u2466"}],"title":"5.1. Choose a policy for a request"},{"refs":[{"id":"ref-for-policy-cache\u2467"}],"title":"5.2. Generate a network error report"},{"refs":[{"id":"ref-for-policy-cache\u2468"}],"title":"7.4. Origins with multiple IP addresses"},{"refs":[{"id":"ref-for-policy-cache\u2460\u24ea"}],"title":"9. Privacy Considerations"}],"url":"#policy-cache"},
"policy-origin": {"dfnID":"policy-origin","dfnText":"origin","external":false,"refSections":[{"refs":[{"id":"ref-for-policy-origin"}],"title":"4.2. Process policy headers"},{"refs":[{"id":"ref-for-policy-origin\u2460"},{"id":"ref-for-policy-origin\u2461"}],"title":"5.2. Generate a network error report"},{"refs":[{"id":"ref-for-policy-origin\u2462"},{"id":"ref-for-policy-origin\u2463"},{"id":"ref-for-policy-origin\u2464"},{"id":"ref-for-policy-origin\u2465"}],"title":"9. Privacy Considerations"}],"url":"#policy-origin"},
"received-ip-address": {"dfnID":"received-ip-address","dfnText":"received IP address","external":false,"refSections":[{"refs":[{"id":"ref-for-received-ip-address"}],"title":"4.2. Process policy headers"},{"refs":[{"id":"ref-for-received-ip-address\u2460"}],"title":"5.2. Generate a network error report"},{"refs":[{"id":"ref-for-received-ip-address\u2461"},{"id":"ref-for-received-ip-address\u2462"},{"id":"ref-for-received-ip-address\u2463"},{"id":"ref-for-received-ip-address\u2464"},{"id":"ref-for-received-ip-address\u2465"},{"id":"ref-for-received-ip-address\u2466"}],"title":"7.4. Origins with multiple IP addresses"},{"refs":[{"id":"ref-for-received-ip-address\u2467"},{"id":"ref-for-received-ip-address\u2468"},{"id":"ref-for-received-ip-address\u2460\u24ea"}],"title":"9. Privacy Considerations"}],"url":"#received-ip-address"},
"report_to": {"dfnID":"report_to","dfnText":"report_to","external":false,"refSections":[{"refs":[{"id":"ref-for-report_to"}],"title":"1. Introduction"},{"refs":[{"id":"ref-for-report_to\u2460"}],"title":"4.1.1. The report_to member"},{"refs":[{"id":"ref-for-report_to\u2461"},{"id":"ref-for-report_to\u2462"}],"title":"4.2. Process policy headers"}],"url":"#report_to"},
"reporting-group": {"dfnID":"reporting-group","dfnText":"reporting group","external":false,"refSections":[{"refs":[{"id":"ref-for-reporting-group"}],"title":"4.2. Process policy headers"},{"refs":[{"id":"ref-for-reporting-group\u2460"}],"title":"5.3. Deliver a network report"}],"url":"#reporting-group"},
"response-headers": {"dfnID":"response-headers","dfnText":"response headers","external":false,"refSections":[{"refs":[{"id":"ref-for-response-headers"}],"title":"4. Policy delivery"},{"refs":[{"id":"ref-for-response-headers\u2460"},{"id":"ref-for-response-headers\u2461"}],"title":"4.1. NEL response header"},{"refs":[{"id":"ref-for-response-headers\u2462"},{"id":"ref-for-response-headers\u2463"}],"title":"4.2. Process policy headers"}],"url":"#response-headers"},
"sampling-rate": {"dfnID":"sampling-rate","dfnText":"sampling rates","external":false,"refSections":[{"refs":[{"id":"ref-for-sampling-rate"}],"title":"4.1.4. The success_fraction member"},{"refs":[{"id":"ref-for-sampling-rate\u2460"}],"title":"4.1.5. The failure_fraction member"}],"url":"#sampling-rate"},
"secure-connection-establishment": {"dfnID":"secure-connection-establishment","dfnText":"Secure connection establishment","external":false,"refSections":[{"refs":[{"id":"ref-for-secure-connection-establishment"}],"title":"3.2. Network errors"},{"refs":[{"id":"ref-for-secure-connection-establishment\u2460"}],"title":"6.2. Secure connection establishment errors"},{"refs":[{"id":"ref-for-secure-connection-establishment\u2461"}],"title":"9. Privacy Considerations"}],"url":"#secure-connection-establishment"},
"server": {"dfnID":"server","dfnText":"server","external":false,"refSections":[{"refs":[{"id":"ref-for-server"},{"id":"ref-for-server\u2460"}],"title":"3.1. Network requests"},{"refs":[{"id":"ref-for-server\u2461"}],"title":"3.4. NEL policies"},{"refs":[{"id":"ref-for-server\u2462"}],"title":"4. Policy delivery"},{"refs":[{"id":"ref-for-server\u2463"}],"title":"4.1.1. The report_to member"},{"refs":[{"id":"ref-for-server\u2464"}],"title":"4.1.2. The max_age member"},{"refs":[{"id":"ref-for-server\u2465"}],"title":"4.2. Process policy headers"},{"refs":[{"id":"ref-for-server\u2466"},{"id":"ref-for-server\u2467"},{"id":"ref-for-server\u2468"}],"title":"5.2. Generate a network error report"},{"refs":[{"id":"ref-for-server\u2460\u24ea"},{"id":"ref-for-server\u2460\u2460"},{"id":"ref-for-server\u2460\u2461"},{"id":"ref-for-server\u2460\u2462"},{"id":"ref-for-server\u2460\u2463"}],"title":"7.4. Origins with multiple IP addresses"},{"refs":[{"id":"ref-for-server\u2460\u2464"},{"id":"ref-for-server\u2460\u2465"},{"id":"ref-for-server\u2460\u2466"},{"id":"ref-for-server\u2460\u2467"},{"id":"ref-for-server\u2460\u2468"}],"title":"9. Privacy Considerations"}],"url":"#server"},
"stale": {"dfnID":"stale","dfnText":"stale","external":false,"refSections":[{"refs":[{"id":"ref-for-stale"}],"title":"5.2. Generate a network error report"}],"url":"#stale"},
"subdomains": {"dfnID":"subdomains","dfnText":"subdomains","external":false,"refSections":[{"refs":[{"id":"ref-for-subdomains"}],"title":"4.2. Process policy headers"},{"refs":[{"id":"ref-for-subdomains\u2460"}],"title":"5.1. Choose a policy for a request"},{"refs":[{"id":"ref-for-subdomains\u2461"},{"id":"ref-for-subdomains\u2462"}],"title":"5.2. Generate a network error report"},{"refs":[{"id":"ref-for-subdomains\u2463"},{"id":"ref-for-subdomains\u2464"}],"title":"9. Privacy Considerations"}],"url":"#subdomains"},
"succeed": {"dfnID":"succeed","dfnText":"successful","external":false,"refSections":[{"refs":[{"id":"ref-for-succeed"}],"title":"3.1. Network requests"},{"refs":[{"id":"ref-for-succeed\u2460"}],"title":"3.5. Sampling rates"},{"refs":[{"id":"ref-for-succeed\u2461"},{"id":"ref-for-succeed\u2462"}],"title":"4.1.4. The success_fraction member"},{"refs":[{"id":"ref-for-succeed\u2463"},{"id":"ref-for-succeed\u2464"},{"id":"ref-for-succeed\u2465"}],"title":"5.2. Generate a network error report"}],"url":"#succeed"},
"success_fraction": {"dfnID":"success_fraction","dfnText":"success_fraction","external":false,"refSections":[{"refs":[{"id":"ref-for-success_fraction"},{"id":"ref-for-success_fraction\u2460"}],"title":"4.2. Process policy headers"}],"url":"#success_fraction"},
"successful-sampling-rate": {"dfnID":"successful-sampling-rate","dfnText":"successful sampling rate","external":false,"refSections":[{"refs":[{"id":"ref-for-successful-sampling-rate"}],"title":"3.1. Network requests"},{"refs":[{"id":"ref-for-successful-sampling-rate\u2460"}],"title":"4.2. Process policy headers"},{"refs":[{"id":"ref-for-successful-sampling-rate\u2461"}],"title":"5.2. Generate a network error report"}],"url":"#successful-sampling-rate"},
"transmission-of-request-and-response": {"dfnID":"transmission-of-request-and-response","dfnText":"Transmission of request and response","external":false,"refSections":[{"refs":[{"id":"ref-for-transmission-of-request-and-response"}],"title":"3.1. Network requests"},{"refs":[{"id":"ref-for-transmission-of-request-and-response\u2460"}],"title":"3.2. Network errors"},{"refs":[{"id":"ref-for-transmission-of-request-and-response\u2461"}],"title":"6.3. Transmission of request and response errors"},{"refs":[{"id":"ref-for-transmission-of-request-and-response\u2462"}],"title":"9. Privacy Considerations"}],"url":"#transmission-of-request-and-response"},
"ttl": {"dfnID":"ttl","dfnText":"ttl","external":false,"refSections":[{"refs":[{"id":"ref-for-ttl"}],"title":"3.4. NEL policies"},{"refs":[{"id":"ref-for-ttl\u2460"}],"title":"4.2. Process policy headers"}],"url":"#ttl"},
"type-phase": {"dfnID":"type-phase","dfnText":"phase","external":false,"refSections":[{"refs":[{"id":"ref-for-type-phase"}],"title":"5.2. Generate a network error report"},{"refs":[{"id":"ref-for-type-phase\u2460"}],"title":"6.1. DNS resolution errors"},{"refs":[{"id":"ref-for-type-phase\u2461"}],"title":"6.2. Secure connection establishment errors"},{"refs":[{"id":"ref-for-type-phase\u2462"}],"title":"6.3. Transmission of request and response errors"}],"url":"#type-phase"},
"types": {"dfnID":"types","dfnText":"type","external":false,"refSections":[{"refs":[{"id":"ref-for-types"}],"title":"3.2. Network errors"},{"refs":[{"id":"ref-for-types\u2460"}],"title":"5.2. Generate a network error report"},{"refs":[{"id":"ref-for-types\u2461"},{"id":"ref-for-types\u2462"},{"id":"ref-for-types\u2463"}],"title":"6. Predefined network error types"}],"url":"#types"},
};

document.addEventListener("DOMContentLoaded", ()=>{
    genAllDfnPanels();

    document.body.addEventListener("click", (e) => {
        // If not handled already, just hide all dfn panels.
        hideAllDfnPanels();
    });
});

window.addEventListener("resize", () => {
    // Pin any visible dfn panel
    queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>positionDfnPanel(el));
});

function genAllDfnPanels() {
    for(const panelData of Object.values(dfnPanelData)) {
        const dfnID = panelData.dfnID;
        const dfn = document.getElementById(dfnID);
        if(!dfn) {
            console.log(`Can't find dfn#${dfnID}.`, panelData);
            continue;
        }
        dfn.panelData = panelData;
        insertDfnPopupAction(dfn);
    }
}

function genDfnPanel(dfn, { dfnID, url, dfnText, refSections, external }) {
    const dfnPanel = mk.aside({
        class: "dfn-panel on",
        id: `infopanel-for-${dfnID}`,
        "data-for": dfnID,
        "aria-labelled-by":`infopaneltitle-for-${dfnID}`,
        },
        mk.span({id:`infopaneltitle-for-${dfnID}`, style:"display:none"},
            `Info about the '${dfnText}' ${external?"external":""} reference.`),
        mk.a({href:url, class:"dfn-link"}, url),
        refSections.length == 0 ? [] :
            mk.b({}, "Referenced in:"),
            mk.ul({},
                ...refSections.map(section=>
                    mk.li({},
                        ...section.refs.map((ref, refI)=>
                            [
                                mk.a({ href: `#${ref.id}` },
                                    (refI == 0) ? section.title : `(${refI + 1})`
                                ),
                                " ",
                            ]
                        ),
                    ),
                ),
            ),
        genLinkingSyntaxes(dfn),
    );

    dfnPanel.addEventListener('click', (event) => {
        if (event.target.nodeName == 'A') {
            scrollToTargetAndHighlight(event);
            pinDfnPanel(dfnPanel);
        }
        event.stopPropagation();
        refocusOnTarget(event);
    });
    dfnPanel.addEventListener('keydown', (event) => {
        if(event.keyCode == 27) { // Escape key
            hideDfnPanel({dfnPanel});
            event.stopPropagation();
            event.preventDefault();
        }
    });

    dfnPanel.dfn = dfn;
    dfn.dfnPanel = dfnPanel;
    return dfnPanel;
}



function hideAllDfnPanels() {
    // Delete the currently-active dfn panel.
    queryAll(".dfn-panel").forEach(dfnPanel=>hideDfnPanel({dfnPanel}));
}

function showDfnPanel(dfn) {
    hideAllDfnPanels(); // Only display one at a time.

    dfn.setAttribute("aria-expanded", "true");

    const dfnPanel = genDfnPanel(dfn, dfn.panelData);

    // Give the dfn a unique tabindex, and then
    // give all the tabbable panel bits successive indexes.
    let tabIndex = 100;
    dfn.tabIndex = tabIndex++;
    const tabbable = dfnPanel.querySelectorAll(":is(a, button)");
    for (const el of tabbable) {
        el.tabIndex = tabIndex++;
    }

    append(document.body, dfnPanel);
    positionDfnPanel(dfnPanel);
}

function positionDfnPanel(dfnPanel) {
    const dfn = dfnPanel.dfn;
    const dfnPos = getBounds(dfn);
    dfnPanel.style.top = dfnPos.bottom + "px";
    dfnPanel.style.left = dfnPos.left + "px";

    const panelPos = dfnPanel.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, dfnPos.left - overflowAmount);
        dfnPanel.style.left = newLeft + "px";
    }
}

function pinDfnPanel(dfnPanel) {
    // Switch it to "activated" state, which pins it.
    dfnPanel.classList.add("activated");
    dfnPanel.style.position = "fixed";
    dfnPanel.style.left = null;
    dfnPanel.style.top = null;
}

function hideDfnPanel({dfn, dfnPanel}) {
    if(!dfnPanel) dfnPanel = dfn.dfnPanel;
    if(!dfn) dfn = dfnPanel.dfn;
    dfn.dfnPanel = undefined;
    dfnPanel.dfn = undefined;
    dfn.setAttribute("aria-expanded", "false");
    dfn.tabIndex = undefined;
    dfnPanel.remove()
}

function toggleDfnPanel(dfn) {
    if(dfn.dfnPanel) {
        hideDfnPanel(dfn);
    } else {
        showDfnPanel(dfn);
    }
}

function insertDfnPopupAction(dfn) {
    dfn.setAttribute('role', 'button');
    dfn.setAttribute('aria-expanded', 'false')
    dfn.tabIndex = 0;
    dfn.classList.add('has-dfn-panel');
    dfn.addEventListener('click', (event) => {
        toggleDfnPanel(dfn);
        event.stopPropagation();
    });
    dfn.addEventListener('keypress', (event) => {
        const kc = event.keyCode;
        // 32->Space, 13->Enter
        if(kc == 32 || kc == 13) {
            toggleDfnPanel(dfn);
            event.stopPropagation();
            event.preventDefault();
        }
    });
}

function refocusOnTarget(event) {
    const target = event.target;
    setTimeout(() => {
        // Refocus on the event.target element.
        // This is needed after browser scrolls to the destination.
        target.focus();
    });
}

// TODO: shared util
// Returns the root-level absolute position {left and top} of element.
function getBounds(el, relativeTo=document.body) {
    const relativeRect = relativeTo.getBoundingClientRect();
    const elRect = el.getBoundingClientRect();
    const top = elRect.top - relativeRect.top;
    const left = elRect.left - relativeRect.left;
    return {
        top,
        left,
        bottom: top + elRect.height,
        right: left + elRect.width,
    }
}

function scrollToTargetAndHighlight(event) {
    let hash = event.target.hash;
    if (hash) {
        hash = decodeURIComponent(hash.substring(1));
        const dest = document.getElementById(hash);
        if (dest) {
            dest.classList.add('highlighted');
            setTimeout(() => dest.classList.remove('highlighted'), 1000);
        }
    }
}

// Functions, divided by link type, that wrap an autolink's
// contents with the appropriate outer syntax.
// Alternately, a string naming another type they format
// the same as.
function needsFor(type) {
    switch(type) {
        case "descriptor":
        case "value":
        case "element-attr":
        case "attr-value":
        case "element-state":
        case "method":
        case "constructor":
        case "argument":
        case "attribute":
        case "const":
        case "dict-member":
        case "event":
        case "enum-value":
        case "stringifier":
        case "serializer":
        case "iterator":
        case "maplike":
        case "setlike":
        case "state":
        case "mode":
        case "context":
        case "facet": return true;

        default: return false;
    }
}
function refusesFor(type) {
    switch(type) {
        case "property":
        case "element":
        case "interface":
        case "namespace":
        case "callback":
        case "dictionary":
        case "enum":
        case "exception":
        case "typedef":
        case "http-header":
        case "permission": return true;

        default: return false;
    }
}
function linkFormatterFromType(type) {
    switch(type) {
        case 'scheme':
        case 'permission':
        case 'dfn': return (text) => `[=${text}=]`;

        case 'abstract-op': return (text) => `[\$${text}\$]`;

        case 'function':
        case 'at-rule':
        case 'selector':
        case 'value': return (text) => `''${text}''`;

        case 'http-header': return (text) => `[:${text}:]`;

        case 'interface':
        case 'constructor':
        case 'method':
        case 'argument':
        case 'attribute':
        case 'callback':
        case 'dictionary':
        case 'dict-member':
        case 'enum':
        case 'enum-value':
        case 'exception':
        case 'const':
        case 'typedef':
        case 'stringifier':
        case 'serializer':
        case 'iterator':
        case 'maplike':
        case 'setlike':
        case 'extended-attribute':
        case 'event':
        case 'idl': return (text) => `{{${text}}}`;

        case 'element-state':
        case 'element-attr':
        case 'attr-value':
        case 'element': return (element) => `<{${element}}>`;

        case 'grammar': return (text) => `${text} (within a <pre class=prod>)`;

        case 'type': return (text)=> `<<${text}>>`;

        case 'descriptor':
        case 'property': return (text) => `'${text}'`;

        default: return;
    };
};

function genLinkingSyntaxes(dfn) {
    if(dfn.tagName != "DFN") return;

    const type = dfn.getAttribute('data-dfn-type');
    if(!type) {
        console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
        return [];
    }

    // Return a function that wraps link text based on the type
    const linkFormatter = linkFormatterFromType(type);
    if(!linkFormatter) {
        console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
        return [];
    }

    let ltAlts;
    if(dfn.hasAttribute('data-lt')) {
        ltAlts = dfn.getAttribute('data-lt')
            .split("|")
            .map(x=>x.trim());
    } else {
        ltAlts = [dfn.textContent.trim()];
    }
    if(type == "type") {
        // lt of "<foo>", but "foo" is the interior;
        // <<foo/bar>> is how you write it with a for,
        // not <foo/<bar>> or whatever.
        for(var i = 0; i < ltAlts.length; i++) {
            const lt = ltAlts[i];
            const match = /<(.*)>/.exec(lt);
            if(match) { ltAlts[i] = match[1]; }
        }
    }

    let forAlts;
    if(dfn.hasAttribute('data-dfn-for')) {
        forAlts = dfn.getAttribute('data-dfn-for')
            .split(",")
            .map(x=>x.trim());
    } else {
        forAlts = [''];
    }

    let linkingSyntaxes = [];
    if(!needsFor(type)) {
        for(const lt of ltAlts) {
            linkingSyntaxes.push(linkFormatter(lt));
        }
    }
    if(!refusesFor(type)) {
        for(const f of forAlts) {
            linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
        }
    }
    return [
        mk.b({}, 'Possible linking syntaxes:'),
        mk.ul({},
            ...linkingSyntaxes.map(link => {
                const copyLink = async () =>
                    await navigator.clipboard.writeText(link);
                return mk.li({},
                    mk.div({ class: 'link-item' },
                        mk.button({
                            class: 'copy-icon', title: 'Copy',
                            type: 'button',
                            _onclick: copyLink,
                            tabindex: 0,
                        }, mk.span({ class: 'icon' }) ),
                        mk.span({}, link)
                    )
                );
            })
        )
    ];
}
}
</script>
<script>/* Boilerplate: script-position-annos */
"use strict";
{
function repositionAnnoPanels(){
    const panels = [...document.querySelectorAll("[data-anno-for]")];
    hydratePanels(panels);
    let vSoFar = 0;
    for(const panel of panels.sort(cmpTops)) {
        if(panel.top < vSoFar) {
            panel.top = vSoFar;
            panel.style.top = vSoFar + "px";
        }
        vSoFar = panel.top + panel.height + 15;
    }
}
function hydratePanels(panels) {
    const main = document.querySelector("main");
    let mainRect;
    if(main) mainRect = main.getBoundingClientRect();
    // First display them all, if they're not already visible.
    for(const panel of panels) {
        panel.classList.remove("unpositioned");
    }
    // Measure them all
    for(const panel of panels) {
        const dfn = document.getElementById(panel.getAttribute("data-anno-for"));
        if(!dfn) {
            console.log("Can't find the annotation panel target:", panel);
            continue;
        }
        panel.dfn = dfn;
        panel.top = window.scrollY + dfn.getBoundingClientRect().top;
        let panelRect = panel.getBoundingClientRect();
        panel.height = panelRect.height;
        if(main) {
            panel.overlappingMain = panelRect.left < mainRect.right;
        } else {
            panel.overlappingMain = false;
        }
    }
    // And finally position them
    for(const panel of panels) {
        const dfn = panel.dfn;
        if(!dfn) continue;
        panel.style.top = panel.top + "px";
        panel.classList.toggle("overlapping-main", panel.overlappingMain);
    }
}

function cmpTops(a,b) {
    return a.top - b.top;
}

window.addEventListener("load", repositionAnnoPanels);
window.addEventListener("resize", repositionAnnoPanels);
}
</script>
<script>/* Boilerplate: script-ref-hints */
"use strict";
{
let refsData = {
"#4xx": {"displayText":"4xx","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"4xx","type":"dfn","url":"#4xx"},
"#5xx": {"displayText":"5xx","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"5xx","type":"dfn","url":"#5xx"},
"#creation": {"displayText":"creation","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"creation","type":"dfn","url":"#creation"},
"#dns-resolution": {"displayText":"dns resolution","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"dns resolution","type":"dfn","url":"#dns-resolution"},
"#domain-name": {"displayText":"domain name","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"domain name","type":"dfn","url":"#domain-name"},
"#domain-namespace-tree": {"displayText":"domain namespace tree","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"domain namespace tree","type":"dfn","url":"#domain-namespace-tree"},
"#expired": {"displayText":"expired","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"expired","type":"dfn","url":"#expired"},
"#fail": {"displayText":"failures","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"failures","type":"dfn","url":"#fail"},
"#failure-sampling-rate": {"displayText":"failure sampling rate","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"failure sampling rate","type":"dfn","url":"#failure-sampling-rate"},
"#failure_fraction": {"displayText":"failure_fraction","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"failure_fraction","type":"dfn","url":"#failure_fraction"},
"#include_subdomains": {"displayText":"include_subdomains","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"include_subdomains","type":"dfn","url":"#include_subdomains"},
"#max_age": {"displayText":"max_age","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"max_age","type":"dfn","url":"#max_age"},
"#nel": {"displayText":"nel","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"nel","type":"dfn","url":"#nel"},
"#nel-policies": {"displayText":"nel policy","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"nel policy","type":"dfn","url":"#nel-policies"},
"#network-error-reports": {"displayText":"network error reports","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"network error reports","type":"dfn","url":"#network-error-reports"},
"#network-errors": {"displayText":"network errors","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"network errors","type":"dfn","url":"#network-errors"},
"#network-request": {"displayText":"network request","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"network request","type":"dfn","url":"#network-request"},
"#phase": {"displayText":"phase","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"phase","type":"dfn","url":"#phase"},
"#policy-cache": {"displayText":"policy cache","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"policy cache","type":"dfn","url":"#policy-cache"},
"#policy-origin": {"displayText":"policy origin","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"policy origin","type":"dfn","url":"#policy-origin"},
"#received-ip-address": {"displayText":"received ip address","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"received ip address","type":"dfn","url":"#received-ip-address"},
"#report_to": {"displayText":"report_to","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"report_to","type":"dfn","url":"#report_to"},
"#reporting-group": {"displayText":"reporting group","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"reporting group","type":"dfn","url":"#reporting-group"},
"#response-headers": {"displayText":"response headers","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"response headers","type":"dfn","url":"#response-headers"},
"#sampling-rate": {"displayText":"sampling rate","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"sampling rate","type":"dfn","url":"#sampling-rate"},
"#secure-connection-establishment": {"displayText":"secure connection establishment","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"secure connection establishment","type":"dfn","url":"#secure-connection-establishment"},
"#server": {"displayText":"server","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"server","type":"dfn","url":"#server"},
"#stale": {"displayText":"stale","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"stale","type":"dfn","url":"#stale"},
"#subdomains": {"displayText":"subdomains","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"subdomains","type":"dfn","url":"#subdomains"},
"#succeed": {"displayText":"successful","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"successful","type":"dfn","url":"#succeed"},
"#success_fraction": {"displayText":"success_fraction","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"success_fraction","type":"dfn","url":"#success_fraction"},
"#successful-sampling-rate": {"displayText":"successful sampling rate","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"successful sampling rate","type":"dfn","url":"#successful-sampling-rate"},
"#transmission-of-request-and-response": {"displayText":"transmission of request and response","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"transmission of request and response","type":"dfn","url":"#transmission-of-request-and-response"},
"#ttl": {"displayText":"ttl","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"ttl","type":"dfn","url":"#ttl"},
"#type-phase": {"displayText":"type-phase","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"type-phase","type":"dfn","url":"#type-phase"},
"#types": {"displayText":"types","export":true,"for_":[],"level":"1","normative":true,"shortname":"network-error-logging","spec":"network-error-logging-1","status":"local","text":"types","type":"dfn","url":"#types"},
"https://fetch.spec.whatwg.org/#concept-request": {"displayText":"request","export":true,"for_":[],"level":"","normative":true,"shortname":"fetch","spec":"fetch","status":"anchor-block","text":"request","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request"},
"https://fetch.spec.whatwg.org/#concept-request-origin": {"displayText":"origin","export":true,"for_":[],"level":"","normative":true,"shortname":"fetch","spec":"fetch","status":"anchor-block","text":"origin","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-origin"},
"https://fetch.spec.whatwg.org/#concept-request-referrer-policy": {"displayText":"referrer policy","export":true,"for_":["request"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"referrer policy","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-referrer-policy"},
"https://fetch.spec.whatwg.org/#concept-request-reserved-client": {"displayText":"reserved client","export":true,"for_":[],"level":"","normative":true,"shortname":"fetch","spec":"fetch","status":"anchor-block","text":"reserved client","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-reserved-client"},
"https://fetch.spec.whatwg.org/#concept-response": {"displayText":"response","export":true,"for_":[],"level":"","normative":true,"shortname":"fetch","spec":"fetch","status":"anchor-block","text":"response","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-response"},
"https://fetch.spec.whatwg.org/#cors-preflight-request": {"displayText":"CORS-preflight request","export":true,"for_":[],"level":"","normative":true,"shortname":"fetch","spec":"fetch","status":"anchor-block","text":"cors-preflight request","type":"dfn","url":"https://fetch.spec.whatwg.org/#cors-preflight-request"},
"https://fetch.spec.whatwg.org/#cors-protocol": {"displayText":"CORS protocol","export":true,"for_":[],"level":"","normative":true,"shortname":"fetch","spec":"fetch","status":"anchor-block","text":"cors protocol","type":"dfn","url":"https://fetch.spec.whatwg.org/#cors-protocol"},
"https://fetch.spec.whatwg.org/#http-network-fetch": {"displayText":"HTTP-network fetch","export":true,"for_":[],"level":"","normative":true,"shortname":"fetch","spec":"fetch","status":"anchor-block","text":"http-network fetch","type":"dfn","url":"https://fetch.spec.whatwg.org/#http-network-fetch"},
"https://html.spec.whatwg.org/multipage/system-state.html#dom-navigator-online": {"displayText":"onLine","export":true,"for_":["NavigatorOnLine"],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"onLine","type":"attribute","url":"https://html.spec.whatwg.org/multipage/system-state.html#dom-navigator-online"},
"https://html.spec.whatwg.org/multipage/webappapis.html#determine-the-network-partition-key": {"displayText":"determine the network partition key","export":true,"for_":[],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"determine the network partition key","type":"dfn","url":"https://html.spec.whatwg.org/multipage/webappapis.html#determine-the-network-partition-key"},
"https://html.spec.whatwg.org/multipage/webappapis.html#network-partition-key": {"displayText":"network partition key","export":true,"for_":[],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"network partition key","type":"dfn","url":"https://html.spec.whatwg.org/multipage/webappapis.html#network-partition-key"},
"https://infra.spec.whatwg.org/#user-agent": {"displayText":"user agent","export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"user agent","type":"dfn","url":"https://infra.spec.whatwg.org/#user-agent"},
"https://svgwg.org/svg2-draft/geometry.html#XProperty": {"displayText":"x","export":true,"for_":[],"level":"2","normative":true,"shortname":"svg","spec":"svg2","status":"current","text":"x","type":"property","url":"https://svgwg.org/svg2-draft/geometry.html#XProperty"},
"https://url.spec.whatwg.org/#concept-host-ip-address": {"displayText":"IP address","export":true,"for_":[],"level":"","normative":true,"shortname":"url","spec":"url","status":"anchor-block","text":"ip address","type":"dfn","url":"https://url.spec.whatwg.org/#concept-host-ip-address"},
"https://url.spec.whatwg.org/#concept-url-fragment": {"displayText":"fragment","export":true,"for_":["url"],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"fragment","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url-fragment"},
"https://url.spec.whatwg.org/#concept-url-path": {"displayText":"path","export":true,"for_":["url"],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"path","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url-path"},
"https://url.spec.whatwg.org/#concept-url-query": {"displayText":"query","export":true,"for_":["url"],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"query","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url-query"},
"https://url.spec.whatwg.org/#concept-url-serializer": {"displayText":"URL serializer","export":true,"for_":[],"level":"","normative":true,"shortname":"url","spec":"url","status":"anchor-block","text":"url serializer","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url-serializer"},
"https://w3c.github.io/hr-time/#dfn-duration-from": {"displayText":"duration from","export":true,"for_":[],"level":"","normative":true,"shortname":"hr-time","spec":"hr-time","status":"anchor-block","text":"duration from","type":"dfn","url":"https://w3c.github.io/hr-time/#dfn-duration-from"},
"https://w3c.github.io/hr-time/#dfn-unsafe-current-time": {"displayText":"unsafe current time","export":true,"for_":[],"level":"","normative":true,"shortname":"hr-time","spec":"hr-time","status":"anchor-block","text":"unsafe current time","type":"dfn","url":"https://w3c.github.io/hr-time/#dfn-unsafe-current-time"},
"https://w3c.github.io/hr-time/#dfn-wall-clock": {"displayText":"wall clock","export":true,"for_":[],"level":"","normative":true,"shortname":"hr-time","spec":"hr-time","status":"anchor-block","text":"wall clock","type":"dfn","url":"https://w3c.github.io/hr-time/#dfn-wall-clock"},
"https://w3c.github.io/reporting/#concept-report": {"displayText":"report","export":true,"for_":[],"level":"","normative":true,"shortname":"reporting","spec":"reporting","status":"anchor-block","text":"report","type":"dfn","url":"https://w3c.github.io/reporting/#concept-report"},
"https://w3c.github.io/reporting/#endpoint-group": {"displayText":"endpoint group","export":true,"for_":[],"level":"","normative":true,"shortname":"reporting","spec":"reporting","status":"anchor-block","text":"endpoint group","type":"dfn","url":"https://w3c.github.io/reporting/#endpoint-group"},
"https://w3c.github.io/reporting/#generate-a-network-report": {"displayText":"Generate a network report","export":true,"for_":[],"level":"","normative":true,"shortname":"reporting","spec":"reporting","status":"anchor-block","text":"generate a network report","type":"dfn","url":"https://w3c.github.io/reporting/#generate-a-network-report"},
"https://w3c.github.io/reporting/#report-body": {"displayText":"body","export":true,"for_":["report"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"current","text":"body","type":"dfn","url":"https://w3c.github.io/reporting/#report-body"},
"https://w3c.github.io/reporting/#report-type": {"displayText":"report type","export":true,"for_":[],"level":"","normative":true,"shortname":"reporting","spec":"reporting","status":"anchor-block","text":"report type","type":"dfn","url":"https://w3c.github.io/reporting/#report-type"},
"https://w3c.github.io/reporting/#visible-to-reportingobservers": {"displayText":"visible to ReportingObservers","export":true,"for_":[],"level":"","normative":true,"shortname":"reporting","spec":"reporting","status":"anchor-block","text":"visible to reportingobservers","type":"dfn","url":"https://w3c.github.io/reporting/#visible-to-reportingobservers"},
"https://w3c.github.io/webappsec-mixed-content/#mixed-content": {"displayText":"mixed content","export":true,"for_":[],"level":"","normative":true,"shortname":"mixed-content","spec":"mixed-content","status":"anchor-block","text":"mixed content","type":"dfn","url":"https://w3c.github.io/webappsec-mixed-content/#mixed-content"},
"https://www.w3.org/TR/secure-contexts/#is-origin-trustworthy": {"displayText":"Is origin potentially trustworthy?","export":true,"for_":[],"level":"","normative":true,"shortname":"secure-contexts","spec":"secure-contexts","status":"anchor-block","text":"is origin potentially trustworthy?","type":"dfn","url":"https://www.w3.org/TR/secure-contexts/#is-origin-trustworthy"},
"https://www.w3.org/TR/secure-contexts/#potentially-trustworthy-origin": {"displayText":"potentially trustworthy origin","export":true,"for_":[],"level":"","normative":true,"shortname":"secure-contexts","spec":"secure-contexts","status":"anchor-block","text":"potentially trustworthy origin","type":"dfn","url":"https://www.w3.org/TR/secure-contexts/#potentially-trustworthy-origin"},
};

function mkRefHint(link, ref) {
    const linkText = link.textContent;
    let dfnTextElements = '';
    if (ref.displayText.toLowerCase() != linkText.toLowerCase()) {
        // Give the original term if it's being displayed in a different way.
        // But allow casing differences, they're insignificant.
        dfnTextElements =
            mk.li({},
                mk.b({}, "Term: "),
                mk.span({}, ref.displayText)
            );
    }
    const forList = ref.for_;
    let forListElements;
    if(forList.length == 0) {
        forListElements = [];
    } else if(forList.length == 1) {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.span({}, forList[0]),
        );
    } else {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.ul({},
                ...forList.map(forItem =>
                    mk.li({},
                        mk.span({}, forItem)
                    ),
                ),
            ),
        );
    }
    const url = ref.url;
    const safeUrl = encodeURIComponent(url);
    const hintPanel = mk.aside({
        class: "ref-hint",
        id: `ref-hint-for-${safeUrl}`,
        "data-for": url,
        "aria-labelled-by": `ref-hint-for-${safeUrl}`,
    },
        mk.ul({},
            dfnTextElements,
            mk.li({},
                mk.b({}, "URL: "),
                mk.a({ href: url, class: "ref" }, url),
            ),
            mk.li({},
                mk.b({}, "Type: "),
                mk.span({}, `${ref.type}`),
            ),
            mk.li({},
                mk.b({}, "Spec: "),
                mk.span({}, `${ref.spec ? ref.spec : ''}`),
            ),
            forListElements
        ),
    );
    hintPanel.forLink = link;
    setupRefHintEventListeners(link, hintPanel);
    return hintPanel;
}

function hideAllRefHints() {
    queryAll(".ref-hint").forEach(el=>hideRefHint(el));
}

function hideRefHint(refHint) {
    const link = refHint.forLink;
    link.setAttribute("aria-expanded", "false");
    if(refHint.teardownEventListeners) {
        refHint.teardownEventListeners();
    }
    refHint.remove();
}

function showRefHint(link) {
    if(link.classList.contains("dfn-link")) return;
    const url = link.getAttribute("href");
    const ref = refsData[url];
    if(!ref) return;

    hideAllRefHints(); // Only display one at this time.

    const refHint = mkRefHint(link, ref);
    append(document.body, refHint);
    link.setAttribute("aria-expanded", "true");
    positionRefHint(refHint);
}

function setupRefHintEventListeners(link, refHint) {
    if (refHint.teardownEventListeners) return;
    // Add event handlers to hide the refHint after the user moves away
    // from both the link and refHint, if not hovering either within one second.
    let timeout = null;
    const startHidingRefHint = (event) => {
        if (timeout) {
            clearTimeout(timeout);
        }
        timeout = setTimeout(() => {
            hideRefHint(refHint);
        }, 1000);
    }
    const resetHidingRefHint = (event) => {
        if (timeout) clearTimeout(timeout);
        timeout = null;
    };
    link.addEventListener("mouseleave", startHidingRefHint);
    link.addEventListener("mouseenter", resetHidingRefHint);
    link.addEventListener("blur", startHidingRefHint);
    link.addEventListener("focus", resetHidingRefHint);
    refHint.addEventListener("mouseleave", startHidingRefHint);
    refHint.addEventListener("mouseenter", resetHidingRefHint);
    refHint.addEventListener("blur", startHidingRefHint);
    refHint.addEventListener("focus", resetHidingRefHint);

    refHint.teardownEventListeners = () => {
        // remove event listeners
        resetHidingRefHint();
        link.removeEventListener("mouseleave", startHidingRefHint);
        link.removeEventListener("mouseenter", resetHidingRefHint);
        link.removeEventListener("blur", startHidingRefHint);
        link.removeEventListener("focus", resetHidingRefHint);
        refHint.removeEventListener("mouseleave", startHidingRefHint);
        refHint.removeEventListener("mouseenter", resetHidingRefHint);
        refHint.removeEventListener("blur", startHidingRefHint);
        refHint.removeEventListener("focus", resetHidingRefHint);
    };
}

function positionRefHint(refHint) {
    const link = refHint.forLink;
    const linkPos = getBounds(link);
    refHint.style.top = linkPos.bottom + "px";
    refHint.style.left = linkPos.left + "px";

    const panelPos = refHint.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, linkPos.left - overflowAmount);
        refHint.style.left = newLeft + "px";
    }
}

// TODO: shared util
// Returns the root-level absolute position {left and top} of element.
function getBounds(el, relativeTo=document.body) {
    const relativeRect = relativeTo.getBoundingClientRect();
    const elRect = el.getBoundingClientRect();
    const top = elRect.top - relativeRect.top;
    const left = elRect.left - relativeRect.left;
    return {
        top,
        left,
        bottom: top + elRect.height,
        right: left + elRect.width,
    }
}

function showRefHintListener(e) {
    // If the target isn't in a link (or is a link),
    // just ignore it.
    let link = e.target.closest("a");
    if(!link) return;

    // If the target is in a ref-hint panel
    // (aka a link in the already-open one),
    // also just ignore it.
    if(link.closest(".ref-hint")) return;

    // Otherwise, show the panel for the link.
    showRefHint(link);
}

function hideAllHintsListener(e) {
    // If the click is inside a ref-hint panel, ignore it.
    if(e.target.closest(".ref-hint")) return;
    // Otherwise, close all the current panels.
    hideAllRefHints();
}

document.addEventListener("DOMContentLoaded", () => {
    document.body.addEventListener("mousedown", showRefHintListener);
    document.body.addEventListener("focus", showRefHintListener);

    document.body.addEventListener("click", hideAllHintsListener);
});

window.addEventListener("resize", () => {
    // Hide any open ref hint.
    hideAllRefHints();
});
}
</script>